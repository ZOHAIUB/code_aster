! --------------------------------------------------------------------
! Copyright (C) 1991 - 2025 - EDF R&D - www.code-aster.org
! This file is part of code_aster.
!
! code_aster is free software: you can redistribute it and/or modify
! it under the terms of the GNU General Public License as published by
! the Free Software Foundation, either version 3 of the License, or
! (at your option) any later version.
!
! code_aster is distributed in the hope that it will be useful,
! but WITHOUT ANY WARRANTY; without even the implied warranty of
! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
! GNU General Public License for more details.
!
! You should have received a copy of the GNU General Public License
! along with code_aster.  If not, see <http://www.gnu.org/licenses/>.
! --------------------------------------------------------------------
!
subroutine dxqloc2(flex, memb, mefl, ctor, matloc)
    implicit none
#include "jeveux.h"
    real(kind=8) :: flex(*), memb(*), mefl(*), ctor
    real(kind=8) :: matloc(*)
!----------------------------------------------------------
!     IN  FLEX   : MATRICE DE FLEXION CARREE
!     IN  MEMB   : MATRICE DE MEMBRANE CARREE
!     IN  MEFL   : MATRICE MEMBRANE - FLEXION CARREE
!     IN  CTOR   : COEFF DE TORSION
!     OUT MATLOC : MATRICE DE RIGIDITE OU DE MASSE LOCALE
!                  REMPLISSAGE DE MATELEM LOCAL (300 TERMES) AVEC
!                      64 TERMES DE MEMBRANE DX DY
!                     144 TERMES DE FLEXION  DZ DRX DRY
!                     192 TERMES DE MEMBRANE/FLEXION
!                       4 TERMES DE ROTATION DRZ
!----------------------------------------------------------
    integer(kind=8) :: jf(144)
    integer(kind=8) :: jm(64)
    integer(kind=8) :: jfm(96)
    integer(kind=8) :: jmf(96)
    integer(kind=8) :: jz(4)
    real(kind=8) :: coef
    real(kind=8) :: cf(144), cfm(96)
!     ------------------------------------------------------------------
!-----------------------------------------------------------------------
    integer(kind=8) :: i, k
!-----------------------------------------------------------------------
    data cf/&
     &   2*1.d0, -1.d0, 2*1.d0, -1.d0, 2*1.d0, -1.d0, 2*1.d0, -1.d0,&
     &   2*1.d0, -1.d0, 2*1.d0, -1.d0, 2*1.d0, -1.d0, 2*1.d0, -1.d0,&
     &   2*-1.d0, 1.d0, 2*-1.d0, 1.d0, 2*-1.d0, 1.d0, 2*-1.d0, 1.d0,&
     &   2*1.d0, -1.d0, 2*1.d0, -1.d0, 2*1.d0, -1.d0, 2*1.d0, -1.d0,&
     &   2*1.d0, -1.d0, 2*1.d0, -1.d0, 2*1.d0, -1.d0, 2*1.d0, -1.d0,&
     &   2*-1.d0, 1.d0, 2*-1.d0, 1.d0, 2*-1.d0, 1.d0, 2*-1.d0, 1.d0,&
     &   2*1.d0, -1.d0, 2*1.d0, -1.d0, 2*1.d0, -1.d0, 2*1.d0, -1.d0,&
     &   2*1.d0, -1.d0, 2*1.d0, -1.d0, 2*1.d0, -1.d0, 2*1.d0, -1.d0,&
     &   2*-1.d0, 1.d0, 2*-1.d0, 1.d0, 2*-1.d0, 1.d0, 2*-1.d0, 1.d0,&
     &   2*1.d0, -1.d0, 2*1.d0, -1.d0, 2*1.d0, -1.d0, 2*1.d0, -1.d0,&
     &   2*1.d0, -1.d0, 2*1.d0, -1.d0, 2*1.d0, -1.d0, 2*1.d0, -1.d0,&
     &   2*-1.d0, 1.d0, 2*-1.d0, 1.d0, 2*-1.d0, 1.d0, 2*-1.d0, 1.d0/
!     ------------------------------------------------------------------
    data cfm/16*1.d0, 8*-1.d0, 16*1.d0, 8*-1.d0, 16*1.d0, 8*-1.d0, 16*1.d0, 8*-1.d0/
!     ------------------------------------------------------------------
    data jf/&
     &   51, 53, 52, 57, 59, 58, 63, 65, 64, 69, 71, 70,&
     &   99, 101, 100, 105, 107, 106, 111, 113, 112, 117, 119, 118,&
     &   75, 77, 76, 81, 83, 82, 87, 89, 88, 93, 95, 94,&
     &  195, 197, 196, 201, 203, 202, 207, 209, 208, 213, 215, 214,&
     &  243, 245, 244, 249, 251, 250, 255, 257, 256, 261, 263, 262,&
     &  219, 221, 220, 225, 227, 226, 231, 233, 232, 237, 239, 238,&
     &  339, 341, 340, 345, 347, 346, 351, 353, 352, 357, 359, 358,&
     &  387, 389, 388, 393, 395, 394, 399, 401, 400, 405, 407, 406,&
     &  363, 365, 364, 369, 371, 370, 375, 377, 376, 381, 383, 382,&
     &  483, 485, 484, 489, 491, 490, 495, 497, 496, 501, 503, 502,&
     &  531, 533, 532, 537, 539, 538, 543, 545, 544, 549, 551, 550,&
     &  507, 509, 508, 513, 515, 514, 519, 521, 520, 525, 527, 526/
!     ------------------------------------------------------------------
    data jm/&
     &    1, 2, 7, 8, 13, 14, 19, 20,&
     &   25, 26, 31, 32, 37, 38, 43, 44,&
     &  145, 146, 151, 152, 157, 158, 163, 164,&
     &  169, 170, 175, 176, 181, 182, 187, 188,&
     &  289, 290, 295, 296, 301, 302, 307, 308,&
     &  313, 314, 319, 320, 325, 326, 331, 332,&
     &  433, 434, 439, 440, 445, 446, 451, 452,&
     &  457, 458, 463, 464, 469, 470, 475, 476/
!     ------------------------------------------------------------------
    data jfm/&
     &   49, 50, 55, 56, 61, 62, 67, 68,&
     &   97, 98, 103, 104, 109, 110, 115, 116,&
     &   73, 74, 79, 80, 85, 86, 91, 92,&
     &  193, 194, 199, 200, 205, 206, 211, 212,&
     &  241, 242, 247, 248, 253, 254, 259, 260,&
     &  217, 218, 223, 224, 229, 230, 235, 236,&
     &  337, 338, 343, 344, 349, 350, 355, 356,&
     &  385, 386, 391, 392, 397, 398, 403, 404,&
     &  361, 362, 367, 368, 373, 374, 379, 380,&
     &  481, 482, 487, 488, 493, 494, 499, 500,&
     &  529, 530, 535, 536, 541, 542, 547, 548,&
     &  505, 506, 511, 512, 517, 518, 523, 524/
!     ------------------------------------------------------------------
    data jmf/&
     &   3, 27, 147, 171, 291, 315, 435, 459,&
     &   5, 29, 149, 173, 293, 317, 437, 461,&
     &   4, 28, 148, 172, 292, 316, 436, 460,&
     &   9, 33, 153, 177, 297, 321, 441, 465,&
     &  11, 35, 155, 179, 299, 323, 443, 467,&
     &  10, 34, 154, 178, 298, 322, 442, 466,&
     &  15, 39, 159, 183, 303, 327, 447, 471,&
     &  17, 41, 161, 185, 305, 329, 449, 473,&
     &  16, 40, 160, 184, 304, 328, 448, 472,&
     &  21, 45, 165, 189, 309, 333, 453, 477,&
     &  23, 47, 167, 191, 311, 335, 455, 479,&
     &  22, 46, 166, 190, 310, 334, 454, 478/
!     ------------------------------------------------------------------
    data jz/126, 276, 426, 576/
!     ------------------------------------------------------------------
!                          ---- RAZ MATLOC
    do i = 1, 576
        matloc(i) = 0.0d0
    end do
!                          ---- TERMES DE FLEXION
    do k = 1, 144
        matloc(jf(k)) = cf(k)*flex(k)
    end do
!                          ---- TERMES DE MEMBRANE
    do k = 1, 64
        matloc(jm(k)) = memb(k)
    end do
!                          ---- TERMES DE COUPLAGE FLEXION/MEMBRANE et MEMBRANE/FLEXION
    do k = 1, 96
        matloc(jfm(k)) = cfm(k)*mefl(k)
        matloc(jmf(k)) = cfm(k)*mefl(k)
    end do
!                          ---- TERMES DE ROTATION / Z
    coef = ctor*min( &
           flex(14), flex(27), flex(53), flex(66), flex(92), flex(105), flex(131), flex(144))
    matloc(jz(1)) = coef
    matloc(jz(2)) = coef
    matloc(jz(3)) = coef
    matloc(jz(4)) = coef
end subroutine
