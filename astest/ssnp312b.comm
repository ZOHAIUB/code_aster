# coding=utf-8
# --------------------------------------------------------------------
# Copyright (C) 1991 - 2025 - EDF R&D - www.code-aster.org
# This file is part of code_aster.
#
# code_aster is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# code_aster is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with code_aster.  If not, see <http://www.gnu.org/licenses/>.
# --------------------------------------------------------------------

#                 FISSURE PARALLELE A L'INTERFACE
#
# ELEMENTS QUADRATIQUES

DEBUT(CODE="OUI")

MA = LIRE_MAILLAGE(VERI_MAIL=_F(VERIF="NON"), FORMAT="MED")

MO = AFFE_MODELE(MAILLAGE=MA, AFFE=_F(TOUT="OUI", PHENOMENE="MECANIQUE", MODELISATION="D_PLAN"))

TRAC1 = DEFI_FONCTION(
    NOM_PARA="EPSI", VALE=(0.00155, 310.0, 0.4, 600.0, 1.0, 700.0), PROL_DROITE="LINEAIRE"
)

TRAC2 = DEFI_FONCTION(
    NOM_PARA="EPSI", VALE=(0.00221, 442.0, 0.4, 600.0, 1.0, 650.0), PROL_DROITE="LINEAIRE"
)

MAT1 = DEFI_MATERIAU(ELAS=_F(E=200000.0, NU=0.3, ALPHA=0.0), TRACTION=_F(SIGM=TRAC1))

MAT2 = DEFI_MATERIAU(ELAS=_F(E=200000.0, NU=0.3, ALPHA=0.0), TRACTION=_F(SIGM=TRAC2))

MAT3 = DEFI_MATERIAU(ELAS=_F(E=60000000000.0, NU=0.3, ALPHA=0.0))

CHMAT = AFFE_MATERIAU(
    MAILLAGE=MA,
    AFFE=(
        _F(GROUP_MA="AUSTENI", MATER=MAT1),
        _F(GROUP_MA="FERRITI", MATER=MAT2),
        _F(GROUP_MA="GOUP", MATER=MAT3),
    ),
)

CL = AFFE_CHAR_MECA(
    MODELE=MO,
    DDL_IMPO=(_F(GROUP_NO="PB", DX=0.0), _F(GROUP_NO="PB", DY=0.0), _F(GROUP_NO="PA", DX=0.0)),
)

CH = AFFE_CHAR_MECA(MODELE=MO, DDL_IMPO=_F(GROUP_NO="PA", DY=1.0))

RAMPE = DEFI_FONCTION(
    NOM_PARA="INST", VALE=(0.0, 0.0, 1.0, 1.0), PROL_DROITE="LINEAIRE", PROL_GAUCHE="LINEAIRE"
)

L_INST = DEFI_LIST_REEL(
    DEBUT=0.0, INTERVALLE=(_F(JUSQU_A=0.4, NOMBRE=40), _F(JUSQU_A=1.0, NOMBRE=180))
)

CHAMDEPL = STAT_NON_LINE(
    MODELE=MO,
    CHAM_MATER=CHMAT,
    EXCIT=(_F(CHARGE=CL), _F(CHARGE=CH, FONC_MULT=RAMPE)),
    COMPORTEMENT=(
        _F(RELATION="ELAS_VMIS_TRAC", GROUP_MA=("AUSTENI", "FERRITI")),
        _F(RELATION="ELAS", GROUP_MA="GOUP"),
    ),
    INCREMENT=_F(LIST_INST=L_INST),
    NEWTON=_F(MATRICE="TANGENTE", REAC_ITER=1),
)


CHAMDEPL = CALC_CHAMP(
    reuse=CHAMDEPL, RESULTAT=CHAMDEPL, CONTRAINTE=("SIGM_ELNO"), VARI_INTERNE=("VARI_ELNO")
)


FOND_NEW = DEFI_FOND_FISS(
    MAILLAGE=MA,
    SYME="NON",
    FOND_FISS=_F(GROUP_NO="PFI1"),
    LEVRE_SUP=_F(GROUP_MA="LEVR_SUP"),
    LEVRE_INF=_F(GROUP_MA="LEVR_INF"),
)

# COURONNES POUR LES CHAMPS THETA
r_inf = [0.02, 0.2, 1.0, 2.0, 3.0]
r_sup = [0.18, 1.0, 2.0, 3.0, 5.0]

#
# CALCUL DE G THETA POUR LES 5 CHAMPS THETA
# -----------------------------------------

G_0 = CALC_G(
    OPTION="G", THETA=_F(R_INF=r_inf[0], R_SUP=r_sup[0], FISSURE=FOND_NEW), RESULTAT=CHAMDEPL
)

G_1 = CALC_G(
    OPTION="G", THETA=_F(R_INF=r_inf[1], R_SUP=r_sup[1], FISSURE=FOND_NEW), RESULTAT=CHAMDEPL
)

G_2 = CALC_G(
    OPTION="G", THETA=_F(R_INF=r_inf[2], R_SUP=r_sup[2], FISSURE=FOND_NEW), RESULTAT=CHAMDEPL
)

G_3 = CALC_G(
    OPTION="G", THETA=_F(R_INF=r_inf[3], R_SUP=r_sup[3], FISSURE=FOND_NEW), RESULTAT=CHAMDEPL
)

G_4 = CALC_G(
    OPTION="G", THETA=_F(R_INF=r_inf[4], R_SUP=r_sup[4], FISSURE=FOND_NEW), RESULTAT=CHAMDEPL
)

#
# TEST DES RESULTATS COURONNE 0
# -----------------------------

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.08,
    VALE_CALC=5.378529664371163,
    VALE_REFE=5.8243999999999998,
    NOM_PARA="G",
    TABLE=G_0,
    FILTRE=_F(NOM_PARA="INST", VALE=0.2),
)

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.08,
    VALE_CALC=20.875613312557835,
    VALE_REFE=22.600000000000001,
    NOM_PARA="G",
    TABLE=G_0,
    FILTRE=_F(NOM_PARA="INST", VALE=0.4),
)

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.07,
    VALE_CALC=43.93557405522918,
    VALE_REFE=47.240000000000002,
    NOM_PARA="G",
    TABLE=G_0,
    FILTRE=_F(NOM_PARA="INST", VALE=0.6),
)

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.08,
    VALE_CALC=68.84685804238917,
    VALE_REFE=74.703999999999994,
    NOM_PARA="G",
    TABLE=G_0,
    FILTRE=_F(NOM_PARA="INST", VALE=0.8),
)

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.09,
    VALE_CALC=94.47495658261475,
    VALE_REFE=103.73999999999999,
    NOM_PARA="G",
    TABLE=G_0,
    FILTRE=_F(NOM_PARA="INST", VALE=1.0),
)

#
# IMPRESSION DES RESULTATS COURONNE 1
# -----------------------------------

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.089999999999999997,
    VALE_CALC=5.374681378695559,
    VALE_REFE=5.8243999999999998,
    NOM_PARA="G",
    TABLE=G_1,
    FILTRE=_F(NOM_PARA="INST", VALE=0.2),
)

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.10000000000000001,
    VALE_CALC=20.840155683667366,
    VALE_REFE=22.600000000000001,
    NOM_PARA="G",
    TABLE=G_1,
    FILTRE=_F(NOM_PARA="INST", VALE=0.4),
)

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.089999999999999997,
    VALE_CALC=43.82448076619183,
    VALE_REFE=47.240000000000002,
    NOM_PARA="G",
    TABLE=G_1,
    FILTRE=_F(NOM_PARA="INST", VALE=0.6),
)

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.092999999999999999,
    VALE_CALC=68.62391508625122,
    VALE_REFE=74.703999999999994,
    NOM_PARA="G",
    TABLE=G_1,
    FILTRE=_F(NOM_PARA="INST", VALE=0.8),
)

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.105,
    VALE_CALC=94.15426413517447,
    VALE_REFE=103.73999999999999,
    NOM_PARA="G",
    TABLE=G_1,
    FILTRE=_F(NOM_PARA="INST", VALE=1.0),
)

#
# IMPRESSION DES RESULTATS COURONNE 2
# -----------------------------------

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.080000000000000002,
    VALE_CALC=5.374711295945669,
    VALE_REFE=5.8243999999999998,
    NOM_PARA="G",
    TABLE=G_2,
    FILTRE=_F(NOM_PARA="INST", VALE=0.2),
)

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.08,
    VALE_CALC=20.840169549495325,
    VALE_REFE=22.600000000000001,
    NOM_PARA="G",
    TABLE=G_2,
    FILTRE=_F(NOM_PARA="INST", VALE=0.4),
)

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.08,
    VALE_CALC=43.82470278021922,
    VALE_REFE=47.240000000000002,
    NOM_PARA="G",
    TABLE=G_2,
    FILTRE=_F(NOM_PARA="INST", VALE=0.6),
)

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.082000000000000003,
    VALE_CALC=68.6504339776096,
    VALE_REFE=74.703999999999994,
    NOM_PARA="G",
    TABLE=G_2,
    FILTRE=_F(NOM_PARA="INST", VALE=0.8),
)

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.10000000000000001,
    VALE_CALC=94.2301118384719,
    VALE_REFE=103.73999999999999,
    NOM_PARA="G",
    TABLE=G_2,
    FILTRE=_F(NOM_PARA="INST", VALE=1.0),
)

#
# IMPRESSION DES RESULTATS COURONNE 3
# -----------------------------------

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.10000000000000001,
    VALE_CALC=5.375011747232663,
    VALE_REFE=5.8243999999999998,
    NOM_PARA="G",
    TABLE=G_3,
    FILTRE=_F(NOM_PARA="INST", VALE=0.2),
)

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.11,
    VALE_CALC=20.84000696375268,
    VALE_REFE=22.600000000000001,
    NOM_PARA="G",
    TABLE=G_3,
    FILTRE=_F(NOM_PARA="INST", VALE=0.4),
)

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.10000000000000001,
    VALE_CALC=43.80342326102787,
    VALE_REFE=47.240000000000002,
    NOM_PARA="G",
    TABLE=G_3,
    FILTRE=_F(NOM_PARA="INST", VALE=0.6),
)

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.10299999999999999,
    VALE_CALC=68.5761853747478,
    VALE_REFE=74.703999999999994,
    NOM_PARA="G",
    TABLE=G_3,
    FILTRE=_F(NOM_PARA="INST", VALE=0.8),
)

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.112,
    VALE_CALC=94.11627910150133,
    VALE_REFE=103.73999999999999,
    NOM_PARA="G",
    TABLE=G_3,
    FILTRE=_F(NOM_PARA="INST", VALE=1.0),
)

#
# IMPRESSION DES RESULTATS COURONNE 4
# -----------------------------------

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.080000000000000002,
    VALE_CALC=5.375039940756265,
    VALE_REFE=5.8243999999999998,
    NOM_PARA="G",
    TABLE=G_4,
    FILTRE=_F(NOM_PARA="INST", VALE=0.2),
)

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.09,
    VALE_CALC=20.840989534954097,
    VALE_REFE=22.600000000000001,
    NOM_PARA="G",
    TABLE=G_4,
    FILTRE=_F(NOM_PARA="INST", VALE=0.4),
)

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.080000000000000002,
    VALE_CALC=43.80035460777386,
    VALE_REFE=47.240000000000002,
    NOM_PARA="G",
    TABLE=G_4,
    FILTRE=_F(NOM_PARA="INST", VALE=0.6),
)

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.09,
    VALE_CALC=68.50106275322317,
    VALE_REFE=74.703999999999994,
    NOM_PARA="G",
    TABLE=G_4,
    FILTRE=_F(NOM_PARA="INST", VALE=0.8),
)

TEST_TABLE(
    REFERENCE="SOURCE_EXTERNE",
    PRECISION=0.10100000000000001,
    VALE_CALC=93.962252625065,
    VALE_REFE=103.73999999999999,
    NOM_PARA="G",
    TABLE=G_4,
    FILTRE=_F(NOM_PARA="INST", VALE=1.0),
)


test = CA.TestCase()
test.assertTrue(True)

FIN()
#
