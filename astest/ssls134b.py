# coding=utf-8
# --------------------------------------------------------------------
# Copyright (C) 1991 - 2025 - EDF R&D - www.code-aster.org
# This file is part of code_aster.
#
# code_aster is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# code_aster is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with code_aster.  If not, see <http://www.gnu.org/licenses/>.
# --------------------------------------------------------------------

import libAsterGC
import numpy as np

from code_aster.Commands import *
from code_aster import CA

CA.init("--test")

test = CA.TestCase()

# values extracted from the first call to dintels by ssls134b.comm
cequi = 21.000000000000000
ht = 0.20000000000000001
bw = 1.0000000000000000
enrobi = 4.0000000000000001e-002
enrobs = 4.0000000000000001e-002
scmaxi = 21000000.000000000
scmaxs = 21000000.000000000
ssmax = 400000000.00000000
uc = 0
dnsinf = 0.0000000000000000
dnssup = 0.0000000000000000
ntot = 696
nrd_ref = [
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    0.0000000000000000,
    153.92015392015392,
    621.96307094266285,
    1413.8438880706919,
    2539.6825396825398,
    4010.0250626566421,
    5835.8662613981751,
    8028.6738351254517,
    10600.414078674950,
    13563.579277864992,
    16931.216931216932,
    20716.960941680045,
    24935.064935064933,
    29600.437876299959,
    34728.682170542641,
    40336.134453781517,
    46439.909297052167,
    53057.946069994279,
    60209.059233449472,
    67912.992357436800,
    76190.476190476198,
    85063.291139240493,
    94554.334554334579,
    104687.69325912182,
    115488.72180451125,
    126984.12698412700,
    139202.05920205923,
    152172.21135029357,
    165925.92592592599,
    180496.31120053653,
    195918.36734693879,
    212229.12353347137,
    229467.78711484597,
    247675.90618336893,
    266897.54689754691,
    287179.48717948707,
    308571.42857142858,
    331126.22826908546,
    354900.15360983100,
    379953.16159250593,
    406349.20634920633,
    434156.57788539131,
    463448.27586206887,
    494302.42272347538,
    526802.72108843550,
    561038.96103896131,
    597107.58377425035,
    635112.30907457334,
    675164.83516483509,
    717385.62091503257,
    761904.76190476201,
    808862.97376093315,
    858412.69841269869,
    890400.00000000000,
    907200.00000000000,
    924000.00000000012,
    940800.00000000012,
    957599.99999999988,
    974399.99999999988,
    991200.00000000000,
    1008000.0000000000,
    1024800.0000000001,
    1041600.0000000000,
    1058400.0000000000,
    1075200.0000000000,
    1092000.0000000000,
    1108800.0000000002,
    1125600.0000000000,
    1142400.0000000000,
    1159200.0000000000,
    1175999.9999999998,
    1192800.0000000000,
    1209600.0000000000,
    1226400.0000000000,
    1243200.0000000000,
    1260000.0000000000,
    1276800.0000000000,
    1293600.0000000000,
    1310400.0000000000,
    1327200.0000000002,
    1344000.0000000000,
    1360800.0000000002,
    1377599.9999999998,
    1394400.0000000000,
    1411200.0000000000,
    1428000.0000000000,
    1444800.0000000000,
    1461600.0000000000,
    1478400.0000000000,
    1495200.0000000000,
    1512000.0000000002,
    1528800.0000000000,
    1545600.0000000000,
    1562400.0000000002,
    1579200.0000000000,
    1596000.0000000000,
    1612799.9999999998,
    1629600.0000000000,
    1646400.0000000000,
    1663200.0000000002,
    1680000.0000000000,
    1696800.0000000000,
    1713600.0000000002,
    1730400.0000000000,
    1747200.0000000002,
    1764000.0000000000,
    1780800.0000000000,
    1797600.0000000002,
    1814400.0000000000,
    1831200.0000000002,
    1848000.0000000002,
    1864800.0000000000,
    1881600.0000000002,
    1898399.9999999998,
    1915199.9999999998,
    1932000.0000000000,
    1948799.9999999998,
    1965600.0000000000,
    1982400.0000000000,
    1999199.9999999998,
    2016000.0000000000,
    2032800.0000000000,
    2049600.0000000002,
    2066400.0000000000,
    2083200.0000000000,
    2100000.0000000000,
    2100000.0000000000,
    2110000.0000000000,
    2120000.0000000000,
    2130000.0000000000,
    2140000.0000000000,
    2150000.0000000000,
    2160000.0000000000,
    2170000.0000000000,
    2180000.0000000000,
    2190000.0000000000,
    2200000.0000000000,
    2210000.0000000000,
    2220000.0000000000,
    2230000.0000000000,
    2240000.0000000000,
    2250000.0000000000,
    2260000.0000000000,
    2270000.0000000000,
    2280000.0000000000,
    2290000.0000000000,
    2300000.0000000000,
    2310000.0000000000,
    2320000.0000000000,
    2330000.0000000000,
    2340000.0000000000,
    2350000.0000000000,
    2360000.0000000000,
    2370000.0000000000,
    2380000.0000000000,
    2390000.0000000000,
    2400000.0000000000,
    2410000.0000000000,
    2420000.0000000000,
    2430000.0000000000,
    2440000.0000000000,
    2450000.0000000000,
    2460000.0000000000,
    2470000.0000000000,
    2480000.0000000000,
    2490000.0000000000,
    2500000.0000000000,
    2510000.0000000000,
    2520000.0000000000,
    2530000.0000000000,
    2540000.0000000000,
    2550000.0000000000,
    2560000.0000000000,
    2570000.0000000000,
    2580000.0000000000,
    2590000.0000000000,
    2600000.0000000000,
    2610000.0000000000,
    2620000.0000000000,
    2630000.0000000000,
    2640000.0000000000,
    2650000.0000000000,
    2660000.0000000000,
    2670000.0000000000,
    2680000.0000000000,
    2690000.0000000000,
    2700000.0000000000,
    2710000.0000000000,
    2720000.0000000000,
    2730000.0000000000,
    2740000.0000000000,
    2750000.0000000000,
    2760000.0000000000,
    2770000.0000000000,
    2780000.0000000000,
    2790000.0000000000,
    2800000.0000000000,
    2810000.0000000000,
    2820000.0000000000,
    2830000.0000000000,
    2840000.0000000000,
    2850000.0000000000,
    2860000.0000000000,
    2870000.0000000000,
    2880000.0000000000,
    2890000.0000000000,
    2900000.0000000000,
    2910000.0000000000,
    2920000.0000000000,
    2930000.0000000000,
    2940000.0000000000,
    2950000.0000000000,
    2960000.0000000000,
    2970000.0000000000,
    2980000.0000000000,
    2990000.0000000000,
    3000000.0000000000,
    3010000.0000000000,
    3020000.0000000000,
    3030000.0000000000,
    3040000.0000000000,
    3050000.0000000000,
    3060000.0000000000,
    3070000.0000000000,
    3080000.0000000000,
    3090000.0000000000,
    3100000.0000000000,
    3110000.0000000000,
    3120000.0000000000,
    3130000.0000000000,
    3140000.0000000000,
    3150000.0000000000,
    3160000.0000000000,
    3170000.0000000000,
    3180000.0000000000,
    3190000.0000000000,
    3200000.0000000000,
    3210000.0000000000,
    3220000.0000000000,
    3230000.0000000000,
    3240000.0000000000,
    3250000.0000000000,
    3260000.0000000000,
    3270000.0000000000,
    3280000.0000000000,
    3290000.0000000000,
    3300000.0000000000,
    3310000.0000000000,
    3320000.0000000000,
    3330000.0000000000,
    3340000.0000000000,
    3350000.0000000000,
    3360000.0000000000,
    3370000.0000000000,
    3380000.0000000000,
    3390000.0000000000,
    3400000.0000000000,
    3410000.0000000000,
    3420000.0000000000,
    3430000.0000000000,
    3440000.0000000000,
    3450000.0000000000,
    3460000.0000000000,
    3470000.0000000000,
    3480000.0000000000,
    3490000.0000000000,
    3500000.0000000000,
    3510000.0000000000,
    3520000.0000000000,
    3530000.0000000000,
    3540000.0000000000,
    3550000.0000000000,
    3560000.0000000000,
    3570000.0000000000,
    3580000.0000000000,
    3590000.0000000000,
    3600000.0000000000,
    3610000.0000000000,
    3620000.0000000000,
    3630000.0000000000,
    3640000.0000000000,
    3650000.0000000000,
    3660000.0000000000,
    3670000.0000000000,
    3680000.0000000000,
    3690000.0000000000,
    3700000.0000000000,
    3710000.0000000000,
    3720000.0000000000,
    3730000.0000000000,
    3740000.0000000000,
    3750000.0000000000,
    3760000.0000000000,
    3770000.0000000000,
    3780000.0000000000,
    3790000.0000000000,
    3800000.0000000000,
    3810000.0000000000,
    3820000.0000000000,
    3830000.0000000000,
    3840000.0000000000,
    3850000.0000000000,
    3860000.0000000000,
    3870000.0000000000,
    3880000.0000000000,
    3890000.0000000000,
    3900000.0000000000,
    3910000.0000000000,
    3920000.0000000000,
    3930000.0000000000,
    3940000.0000000000,
    3950000.0000000000,
    3960000.0000000000,
    3970000.0000000000,
    3980000.0000000000,
    3990000.0000000000,
    4000000.0000000000,
    4010000.0000000000,
    4020000.0000000000,
    4030000.0000000000,
    4040000.0000000000,
    4050000.0000000000,
    4060000.0000000000,
    4070000.0000000000,
    4080000.0000000000,
    4090000.0000000000,
    4100000.0000000000,
    4110000.0000000000,
    4120000.0000000000,
    4130000.0000000000,
    4140000.0000000000,
    4150000.0000000000,
    4160000.0000000000,
    4170000.0000000000,
    4180000.0000000000,
    4190000.0000000000,
    4200000.0000000000,
    4200000.0000000000,
    4190000.0000000000,
    4180000.0000000000,
    4170000.0000000000,
    4160000.0000000000,
    4150000.0000000000,
    4140000.0000000000,
    4130000.0000000000,
    4120000.0000000000,
    4110000.0000000000,
    4100000.0000000000,
    4090000.0000000000,
    4080000.0000000000,
    4070000.0000000000,
    4060000.0000000000,
    4050000.0000000000,
    4040000.0000000000,
    4030000.0000000000,
    4020000.0000000000,
    4010000.0000000000,
    4000000.0000000000,
    3990000.0000000000,
    3980000.0000000000,
    3970000.0000000000,
    3960000.0000000000,
    3950000.0000000000,
    3940000.0000000000,
    3930000.0000000000,
    3920000.0000000000,
    3910000.0000000000,
    3900000.0000000000,
    3890000.0000000000,
    3880000.0000000000,
    3870000.0000000000,
    3860000.0000000000,
    3850000.0000000000,
    3840000.0000000000,
    3830000.0000000000,
    3820000.0000000000,
    3810000.0000000000,
    3800000.0000000000,
    3790000.0000000000,
    3780000.0000000000,
    3770000.0000000000,
    3760000.0000000000,
    3750000.0000000000,
    3740000.0000000000,
    3730000.0000000000,
    3720000.0000000000,
    3710000.0000000000,
    3700000.0000000000,
    3690000.0000000000,
    3680000.0000000000,
    3670000.0000000000,
    3660000.0000000000,
    3650000.0000000000,
    3640000.0000000000,
    3630000.0000000000,
    3620000.0000000000,
    3610000.0000000000,
    3600000.0000000000,
    3590000.0000000000,
    3580000.0000000000,
    3570000.0000000000,
    3560000.0000000000,
    3550000.0000000000,
    3540000.0000000000,
    3530000.0000000000,
    3520000.0000000000,
    3510000.0000000000,
    3500000.0000000000,
    3490000.0000000000,
    3480000.0000000000,
    3470000.0000000000,
    3460000.0000000000,
    3450000.0000000000,
    3440000.0000000000,
    3430000.0000000000,
    3420000.0000000000,
    3410000.0000000000,
    3400000.0000000000,
    3390000.0000000000,
    3380000.0000000000,
    3370000.0000000000,
    3360000.0000000000,
    3350000.0000000000,
    3340000.0000000000,
    3330000.0000000000,
    3320000.0000000000,
    3310000.0000000000,
    3300000.0000000000,
    3290000.0000000000,
    3280000.0000000000,
    3270000.0000000000,
    3260000.0000000000,
    3250000.0000000000,
    3240000.0000000000,
    3230000.0000000000,
    3220000.0000000000,
    3210000.0000000000,
    3200000.0000000000,
    3190000.0000000000,
    3180000.0000000000,
    3170000.0000000000,
    3160000.0000000000,
    3150000.0000000000,
    3140000.0000000000,
    3130000.0000000000,
    3120000.0000000000,
    3110000.0000000000,
    3100000.0000000000,
    3090000.0000000000,
    3080000.0000000000,
    3070000.0000000000,
    3060000.0000000000,
    3050000.0000000000,
    3040000.0000000000,
    3030000.0000000000,
    3020000.0000000000,
    3010000.0000000000,
    3000000.0000000000,
    2990000.0000000000,
    2980000.0000000000,
    2970000.0000000000,
    2960000.0000000000,
    2950000.0000000000,
    2940000.0000000000,
    2930000.0000000000,
    2920000.0000000000,
    2910000.0000000000,
    2900000.0000000000,
    2890000.0000000000,
    2880000.0000000000,
    2870000.0000000000,
    2860000.0000000000,
    2850000.0000000000,
    2840000.0000000000,
    2830000.0000000000,
    2820000.0000000000,
    2810000.0000000000,
    2800000.0000000000,
    2790000.0000000000,
    2780000.0000000000,
    2770000.0000000000,
    2760000.0000000000,
    2750000.0000000000,
    2740000.0000000000,
    2730000.0000000000,
    2720000.0000000000,
    2710000.0000000000,
    2700000.0000000000,
    2690000.0000000000,
    2680000.0000000000,
    2670000.0000000000,
    2660000.0000000000,
    2650000.0000000000,
    2640000.0000000000,
    2630000.0000000000,
    2620000.0000000000,
    2610000.0000000000,
    2600000.0000000000,
    2590000.0000000000,
    2580000.0000000000,
    2570000.0000000000,
    2560000.0000000000,
    2550000.0000000000,
    2540000.0000000000,
    2530000.0000000000,
    2520000.0000000000,
    2510000.0000000000,
    2500000.0000000000,
    2490000.0000000000,
    2480000.0000000000,
    2470000.0000000000,
    2460000.0000000000,
    2450000.0000000000,
    2440000.0000000000,
    2430000.0000000000,
    2420000.0000000000,
    2410000.0000000000,
    2400000.0000000000,
    2390000.0000000000,
    2380000.0000000000,
    2370000.0000000000,
    2360000.0000000000,
    2350000.0000000000,
    2340000.0000000000,
    2330000.0000000000,
    2320000.0000000000,
    2310000.0000000000,
    2300000.0000000000,
    2290000.0000000000,
    2280000.0000000000,
    2270000.0000000000,
    2260000.0000000000,
    2250000.0000000000,
    2240000.0000000000,
    2230000.0000000000,
    2220000.0000000000,
    2210000.0000000000,
    2200000.0000000000,
    2190000.0000000000,
    2180000.0000000000,
    2170000.0000000000,
    2160000.0000000000,
    2150000.0000000000,
    2140000.0000000000,
    2130000.0000000000,
    2120000.0000000000,
    2110000.0000000000,
    2100000.0000000000,
    2100000.0000000000,
    2083200.0000000000,
    2066400.0000000000,
    2049600.0000000002,
    2032800.0000000000,
    2016000.0000000000,
    1999199.9999999998,
    1982400.0000000000,
    1965600.0000000000,
    1948799.9999999998,
    1932000.0000000000,
    1915199.9999999998,
    1898399.9999999998,
    1881600.0000000002,
    1864799.9999999998,
    1848000.0000000002,
    1831200.0000000002,
    1814400.0000000000,
    1797600.0000000002,
    1780800.0000000000,
    1764000.0000000000,
    1747200.0000000002,
    1730400.0000000000,
    1713600.0000000002,
    1696800.0000000000,
    1680000.0000000000,
    1663200.0000000002,
    1646400.0000000000,
    1629600.0000000000,
    1612799.9999999998,
    1596000.0000000000,
    1579200.0000000000,
    1562399.9999999998,
    1545600.0000000000,
    1528799.9999999998,
    1512000.0000000002,
    1495200.0000000000,
    1478400.0000000000,
    1461600.0000000000,
    1444800.0000000000,
    1428000.0000000000,
    1411200.0000000002,
    1394400.0000000000,
    1377600.0000000000,
    1360800.0000000002,
    1344000.0000000000,
    1327200.0000000002,
    1310400.0000000000,
    1293600.0000000000,
    1276800.0000000000,
    1260000.0000000000,
    1243200.0000000000,
    1226400.0000000000,
    1209600.0000000000,
    1192800.0000000000,
    1175999.9999999998,
    1159200.0000000000,
    1142400.0000000000,
    1125600.0000000000,
    1108800.0000000002,
    1092000.0000000000,
    1075200.0000000000,
    1058400.0000000000,
    1041600.0000000000,
    1024800.0000000001,
    1008000.0000000000,
    991200.00000000000,
    974399.99999999988,
    957599.99999999988,
    940800.00000000012,
    924000.00000000012,
    907200.00000000000,
    890400.00000000000,
    858412.69841269869,
    808862.97376093315,
    761904.76190476201,
    717385.62091503257,
    675164.83516483509,
    635112.30907457334,
    597107.58377425035,
    561038.96103896084,
    526802.72108843515,
    494302.42272347567,
    463448.27586206910,
    434156.57788539154,
    406349.20634920633,
    379953.16159250593,
    354900.15360983100,
    331126.22826908546,
    308571.42857142858,
    287179.48717948707,
    266897.54689754691,
    247675.90618336879,
    229467.78711484588,
    212229.12353347146,
    195918.36734693887,
    180496.31120053658,
    165925.92592592599,
    152172.21135029357,
    139202.05920205923,
    126984.12698412700,
    115488.72180451125,
    104687.69325912182,
    94554.334554334535,
    85063.291139240493,
    76190.476190476169,
    67912.992357436757,
    60209.059233449443,
    53057.946069994206,
    46439.909297052101,
    40336.134453781466,
    34728.682170542590,
    29600.437876299893,
    24935.064935064991,
    20716.960941680078,
    16931.216931216964,
    13563.579277865019,
    10600.414078674969,
    8028.6738351254635,
    5835.8662613981878,
    4010.0250626566490,
    2539.6825396825443,
    1413.8438880706949,
    621.96307094266399,
    153.92015392015418,
    0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
]
mrd_ref = [
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    15.309924643257979,
    61.532879818594118,
    139.12223858615610,
    248.55026455026456,
    390.30910609857983,
    564.91185410334333,
    772.89366786141011,
    1014.8129744651486,
    1291.2527472527474,
    1602.8218694885363,
    1950.1565899768152,
    2333.9220779220777,
    2754.8140850209829,
    3213.5607235142129,
    3710.9243697478996,
    4247.7037037037044,
    4824.7358959648127,
    5442.8989547038327,
    6103.1142465216553,
    6806.3492063492076,
    7553.6202531645577,
    8345.9959299959337,
    9184.6002886002880,
    10070.616541353380,
    11005.291005291007,
    11989.937365937369,
    13025.941291585128,
    14114.765432098768,
    15257.954840152022,
    16457.142857142862,
    17714.057510927076,
    19030.528478057891,
    20408.494669509600,
    21850.012506012510,
    23357.264957264953,
    24932.571428571431,
    26578.398589065262,
    28297.372247823860,
    30092.290398126468,
    31966.137566137564,
    33922.100618778582,
    35963.586206896551,
    38094.240044555845,
    40317.968253968269,
    42638.961038961061,
    45061.718988830100,
    47591.082359988031,
    50232.263736263725,
    52990.884531590411,
    55873.015873015873,
    58885.224489795924,
    62034.624338624344,
    63871.360000000001,
    64592.639999999999,
    65296.000000000000,
    65981.440000000002,
    66648.960000000006,
    67298.560000000012,
    67930.240000000005,
    68544.000000000015,
    69139.840000000011,
    69717.760000000009,
    70277.760000000009,
    70819.840000000011,
    71344.000000000015,
    71850.240000000005,
    72338.559999999998,
    72808.959999999992,
    73261.440000000017,
    73696.000000000015,
    74112.640000000014,
    74511.360000000015,
    74892.160000000018,
    75255.040000000023,
    75600.000000000015,
    75927.040000000008,
    76236.160000000003,
    76527.360000000015,
    76800.640000000014,
    77056.000000000000,
    77293.440000000017,
    77512.960000000006,
    77714.560000000012,
    77898.240000000020,
    78064.000000000000,
    78211.840000000011,
    78341.760000000009,
    78453.760000000024,
    78547.840000000011,
    78624.000000000029,
    78682.240000000020,
    78722.560000000012,
    78744.960000000006,
    78749.440000000002,
    78736.000000000015,
    78704.639999999999,
    78655.360000000015,
    78588.160000000018,
    78503.040000000023,
    78400.000000000000,
    78279.040000000023,
    78140.159999999989,
    77983.360000000015,
    77808.639999999999,
    77616.000000000015,
    77405.440000000002,
    77176.960000000006,
    76930.559999999998,
    76666.240000000005,
    76383.999999999985,
    76083.839999999997,
    75765.759999999995,
    75429.760000000009,
    75075.840000000011,
    74704.000000000000,
    74314.240000000020,
    73906.559999999998,
    73480.960000000036,
    73037.440000000046,
    72576.000000000015,
    72096.640000000043,
    71599.360000000030,
    71084.160000000047,
    70551.040000000037,
    70000.000000000029,
    70000.000000000000,
    69666.666666666672,
    69333.333333333343,
    69000.000000000000,
    68666.666666666672,
    68333.333333333343,
    68000.000000000000,
    67666.666666666672,
    67333.333333333343,
    67000.000000000000,
    66666.666666666672,
    66333.333333333343,
    66000.000000000000,
    65666.666666666672,
    65333.333333333343,
    65000.000000000000,
    64666.666666666664,
    64333.333333333343,
    64000.000000000000,
    63666.666666666664,
    63333.333333333343,
    63000.000000000000,
    62666.666666666664,
    62333.333333333343,
    62000.000000000000,
    61666.666666666664,
    61333.333333333343,
    61000.000000000000,
    60666.666666666664,
    60333.333333333343,
    60000.000000000000,
    59666.666666666664,
    59333.333333333343,
    59000.000000000000,
    58666.666666666664,
    58333.333333333343,
    58000.000000000000,
    57666.666666666664,
    57333.333333333343,
    57000.000000000000,
    56666.666666666664,
    56333.333333333343,
    56000.000000000000,
    55666.666666666664,
    55333.333333333343,
    55000.000000000000,
    54666.666666666664,
    54333.333333333343,
    54000.000000000000,
    53666.666666666664,
    53333.333333333343,
    53000.000000000000,
    52666.666666666664,
    52333.333333333336,
    52000.000000000000,
    51666.666666666664,
    51333.333333333336,
    51000.000000000000,
    50666.666666666664,
    50333.333333333336,
    50000.000000000000,
    49666.666666666664,
    49333.333333333336,
    49000.000000000000,
    48666.666666666664,
    48333.333333333336,
    48000.000000000000,
    47666.666666666664,
    47333.333333333336,
    47000.000000000000,
    46666.666666666664,
    46333.333333333336,
    46000.000000000000,
    45666.666666666664,
    45333.333333333336,
    45000.000000000000,
    44666.666666666664,
    44333.333333333336,
    44000.000000000000,
    43666.666666666664,
    43333.333333333336,
    43000.000000000000,
    42666.666666666664,
    42333.333333333336,
    42000.000000000000,
    41666.666666666672,
    41333.333333333336,
    41000.000000000000,
    40666.666666666672,
    40333.333333333336,
    40000.000000000000,
    39666.666666666672,
    39333.333333333336,
    39000.000000000000,
    38666.666666666672,
    38333.333333333336,
    38000.000000000000,
    37666.666666666672,
    37333.333333333336,
    37000.000000000000,
    36666.666666666672,
    36333.333333333336,
    36000.000000000000,
    35666.666666666672,
    35333.333333333336,
    35000.000000000000,
    34666.666666666672,
    34333.333333333336,
    34000.000000000007,
    33666.666666666672,
    33333.333333333336,
    33000.000000000000,
    32666.666666666672,
    32333.333333333332,
    32000.000000000000,
    31666.666666666664,
    31333.333333333332,
    31000.000000000000,
    30666.666666666672,
    30333.333333333332,
    30000.000000000000,
    29666.666666666672,
    29333.333333333328,
    29000.000000000000,
    28666.666666666672,
    28333.333333333332,
    28000.000000000000,
    27666.666666666672,
    27333.333333333328,
    27000.000000000000,
    26666.666666666672,
    26333.333333333332,
    26000.000000000000,
    25666.666666666668,
    25333.333333333343,
    24999.999999999993,
    24666.666666666668,
    24333.333333333332,
    24000.000000000000,
    23666.666666666668,
    23333.333333333332,
    23000.000000000007,
    22666.666666666668,
    22333.333333333332,
    22000.000000000000,
    21666.666666666668,
    21333.333333333332,
    21000.000000000007,
    20666.666666666664,
    20333.333333333336,
    20000.000000000000,
    19666.666666666668,
    19333.333333333336,
    19000.000000000000,
    18666.666666666675,
    18333.333333333336,
    18000.000000000000,
    17666.666666666668,
    17333.333333333336,
    17000.000000000000,
    16666.666666666668,
    16333.333333333327,
    16000.000000000000,
    15666.666666666666,
    15333.333333333336,
    15000.000000000000,
    14666.666666666666,
    14333.333333333341,
    14000.000000000000,
    13666.666666666666,
    13333.333333333336,
    13000.000000000000,
    12666.666666666666,
    12333.333333333334,
    12000.000000000000,
    11666.666666666666,
    11333.333333333334,
    11000.000000000000,
    10666.666666666666,
    10333.333333333334,
    10000.000000000000,
    9666.6666666666679,
    9333.3333333333339,
    9000.0000000000000,
    8666.6666666666679,
    8333.3333333333339,
    8000.0000000000000,
    7666.6666666666679,
    7333.3333333333330,
    7000.0000000000000,
    6666.6666666666679,
    6333.3333333333330,
    6000.0000000000000,
    5666.6666666666670,
    5333.3333333333330,
    5000.0000000000000,
    4666.6666666666670,
    4333.3333333333339,
    4000.0000000000000,
    3666.6666666666665,
    3333.3333333333339,
    3000.0000000000000,
    2666.6666666666665,
    2333.3333333333335,
    2000.0000000000000,
    1666.6666666666670,
    1333.3333333333333,
    1000.0000000000000,
    666.66666666666663,
    333.33333333333331,
    0.0000000000000000,
    0.0000000000000000,
    -333.33333333333331,
    -666.66666666666663,
    -1000.0000000000000,
    -1333.3333333333333,
    -1666.6666666666670,
    -2000.0000000000000,
    -2333.3333333333335,
    -2666.6666666666665,
    -3000.0000000000000,
    -3333.3333333333339,
    -3666.6666666666665,
    -4000.0000000000000,
    -4333.3333333333339,
    -4666.6666666666670,
    -5000.0000000000000,
    -5333.3333333333330,
    -5666.6666666666670,
    -6000.0000000000000,
    -6333.3333333333330,
    -6666.6666666666679,
    -7000.0000000000000,
    -7333.3333333333330,
    -7666.6666666666679,
    -8000.0000000000000,
    -8333.3333333333339,
    -8666.6666666666679,
    -9000.0000000000000,
    -9333.3333333333339,
    -9666.6666666666679,
    -10000.000000000000,
    -10333.333333333334,
    -10666.666666666666,
    -11000.000000000000,
    -11333.333333333334,
    -11666.666666666666,
    -12000.000000000000,
    -12333.333333333334,
    -12666.666666666666,
    -13000.000000000000,
    -13333.333333333336,
    -13666.666666666666,
    -14000.000000000000,
    -14333.333333333327,
    -14666.666666666666,
    -15000.000000000000,
    -15333.333333333336,
    -15666.666666666666,
    -16000.000000000000,
    -16333.333333333341,
    -16666.666666666668,
    -17000.000000000000,
    -17333.333333333336,
    -17666.666666666668,
    -18000.000000000000,
    -18333.333333333336,
    -18666.666666666664,
    -18999.999999999996,
    -19333.333333333336,
    -19666.666666666668,
    -20000.000000000000,
    -20333.333333333343,
    -20666.666666666675,
    -21000.000000000007,
    -21333.333333333332,
    -21666.666666666668,
    -22000.000000000000,
    -22333.333333333332,
    -22666.666666666668,
    -22999.999999999993,
    -23333.333333333328,
    -23666.666666666668,
    -24000.000000000000,
    -24333.333333333332,
    -24666.666666666672,
    -25000.000000000007,
    -25333.333333333343,
    -25666.666666666668,
    -26000.000000000000,
    -26333.333333333332,
    -26666.666666666672,
    -27000.000000000000,
    -27333.333333333328,
    -27666.666666666664,
    -28000.000000000000,
    -28333.333333333332,
    -28666.666666666672,
    -29000.000000000007,
    -29333.333333333343,
    -29666.666666666672,
    -30000.000000000000,
    -30333.333333333332,
    -30666.666666666672,
    -31000.000000000000,
    -31333.333333333332,
    -31666.666666666664,
    -31999.999999999996,
    -32333.333333333332,
    -32666.666666666672,
    -33000.000000000000,
    -33333.333333333336,
    -33666.666666666679,
    -34000.000000000007,
    -34333.333333333336,
    -34666.666666666672,
    -35000.000000000000,
    -35333.333333333336,
    -35666.666666666672,
    -35999.999999999993,
    -36333.333333333336,
    -36666.666666666672,
    -37000.000000000000,
    -37333.333333333336,
    -37666.666666666672,
    -38000.000000000000,
    -38333.333333333343,
    -38666.666666666672,
    -39000.000000000000,
    -39333.333333333336,
    -39666.666666666672,
    -40000.000000000000,
    -40333.333333333328,
    -40666.666666666679,
    -41000.000000000000,
    -41333.333333333336,
    -41666.666666666672,
    -42000.000000000000,
    -42333.333333333336,
    -42666.666666666664,
    -43000.000000000000,
    -43333.333333333336,
    -43666.666666666664,
    -44000.000000000000,
    -44333.333333333336,
    -44666.666666666664,
    -45000.000000000000,
    -45333.333333333336,
    -45666.666666666664,
    -46000.000000000000,
    -46333.333333333336,
    -46666.666666666664,
    -47000.000000000000,
    -47333.333333333336,
    -47666.666666666664,
    -48000.000000000000,
    -48333.333333333336,
    -48666.666666666664,
    -49000.000000000000,
    -49333.333333333336,
    -49666.666666666664,
    -50000.000000000000,
    -50333.333333333336,
    -50666.666666666664,
    -51000.000000000000,
    -51333.333333333336,
    -51666.666666666664,
    -52000.000000000000,
    -52333.333333333336,
    -52666.666666666664,
    -53000.000000000000,
    -53333.333333333343,
    -53666.666666666664,
    -54000.000000000000,
    -54333.333333333343,
    -54666.666666666664,
    -55000.000000000000,
    -55333.333333333343,
    -55666.666666666664,
    -56000.000000000000,
    -56333.333333333343,
    -56666.666666666664,
    -57000.000000000000,
    -57333.333333333343,
    -57666.666666666664,
    -58000.000000000000,
    -58333.333333333343,
    -58666.666666666664,
    -59000.000000000000,
    -59333.333333333343,
    -59666.666666666664,
    -60000.000000000000,
    -60333.333333333343,
    -60666.666666666664,
    -61000.000000000000,
    -61333.333333333343,
    -61666.666666666664,
    -62000.000000000000,
    -62333.333333333343,
    -62666.666666666664,
    -63000.000000000000,
    -63333.333333333343,
    -63666.666666666664,
    -64000.000000000000,
    -64333.333333333343,
    -64666.666666666664,
    -65000.000000000000,
    -65333.333333333343,
    -65666.666666666672,
    -66000.000000000000,
    -66333.333333333343,
    -66666.666666666672,
    -67000.000000000000,
    -67333.333333333343,
    -67666.666666666672,
    -68000.000000000000,
    -68333.333333333343,
    -68666.666666666672,
    -69000.000000000000,
    -69333.333333333343,
    -69666.666666666672,
    -70000.000000000000,
    -70000.000000000029,
    -70551.040000000037,
    -71084.160000000047,
    -71599.360000000030,
    -72096.640000000043,
    -72576.000000000015,
    -73037.440000000046,
    -73480.960000000036,
    -73906.559999999998,
    -74314.240000000020,
    -74704.000000000000,
    -75075.840000000011,
    -75429.760000000009,
    -75765.759999999995,
    -76083.840000000026,
    -76383.999999999985,
    -76666.240000000005,
    -76930.559999999998,
    -77176.960000000006,
    -77405.440000000002,
    -77616.000000000015,
    -77808.639999999999,
    -77983.360000000015,
    -78140.159999999989,
    -78279.040000000023,
    -78400.000000000000,
    -78503.040000000023,
    -78588.160000000018,
    -78655.360000000015,
    -78704.639999999999,
    -78736.000000000015,
    -78749.440000000002,
    -78744.960000000006,
    -78722.560000000012,
    -78682.240000000005,
    -78624.000000000029,
    -78547.840000000011,
    -78453.760000000024,
    -78341.760000000009,
    -78211.840000000011,
    -78064.000000000000,
    -77898.240000000005,
    -77714.560000000012,
    -77512.960000000006,
    -77293.440000000017,
    -77056.000000000000,
    -76800.640000000014,
    -76527.360000000015,
    -76236.160000000003,
    -75927.040000000008,
    -75600.000000000015,
    -75255.040000000023,
    -74892.160000000018,
    -74511.360000000015,
    -74112.640000000014,
    -73696.000000000015,
    -73261.440000000017,
    -72808.959999999992,
    -72338.559999999998,
    -71850.240000000005,
    -71344.000000000015,
    -70819.840000000011,
    -70277.760000000009,
    -69717.760000000009,
    -69139.840000000011,
    -68544.000000000015,
    -67930.240000000005,
    -67298.560000000012,
    -66648.960000000006,
    -65981.440000000002,
    -65296.000000000000,
    -64592.639999999999,
    -63871.360000000001,
    -62034.624338624344,
    -58885.224489795924,
    -55873.015873015873,
    -52990.884531590411,
    -50232.263736263725,
    -47591.082359988031,
    -45061.718988830100,
    -42638.961038961032,
    -40317.968253968240,
    -38094.240044555860,
    -35963.586206896565,
    -33922.100618778590,
    -31966.137566137564,
    -30092.290398126468,
    -28297.372247823860,
    -26578.398589065262,
    -24932.571428571431,
    -23357.264957264953,
    -21850.012506012510,
    -20408.494669509593,
    -19030.528478057884,
    -17714.057510927087,
    -16457.142857142866,
    -15257.954840152028,
    -14114.765432098768,
    -13025.941291585128,
    -11989.937365937369,
    -11005.291005291007,
    -10070.616541353380,
    -9184.6002886002880,
    -8345.9959299959282,
    -7553.6202531645577,
    -6806.3492063492049,
    -6103.1142465216508,
    -5442.8989547038300,
    -4824.7358959648063,
    -4247.7037037036998,
    -3710.9243697478955,
    -3213.5607235142074,
    -2754.8140850209770,
    -2333.9220779220832,
    -1950.1565899768182,
    -1602.8218694885393,
    -1291.2527472527499,
    -1014.8129744651503,
    -772.89366786141113,
    -564.91185410334469,
    -390.30910609858051,
    -248.55026455026501,
    -139.12223858615639,
    -61.532879818594225,
    -15.309924643258002,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
]

test.assertEqual(len(nrd_ref), ntot, msg="size of nrd ref")
test.assertEqual(len(mrd_ref), ntot, msg="size of mrd ref")

nrd, mrd = libAsterGC.dintels(
    cequi, ht, bw, enrobi, enrobs, scmaxi, scmaxs, ssmax, uc, dnsinf, dnssup
)
# print(f"returned: {nrd=}, {mrd=}")
test.assertEqual(len(nrd), ntot, msg="size of nrd")
test.assertEqual(len(mrd), ntot, msg="size of mrd")

nrd = np.array(nrd)
mrd = np.array(mrd)

nrd_diff = abs(nrd_ref - nrd)
test.assertLessEqual(nrd_diff.max(), 1.0e-6, msg="diff nrd")
mrd_diff = abs(mrd_ref - mrd)
test.assertLessEqual(mrd_diff.max(), 1.0e-6, msg="diff mrd")

test.printSummary()

CA.close()
