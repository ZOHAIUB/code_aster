# coding=utf-8
# --------------------------------------------------------------------
# Copyright (C) 1991 - 2025 - EDF R&D - www.code-aster.org
# This file is part of code_aster.
#
# code_aster is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# code_aster is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with code_aster.  If not, see <http://www.gnu.org/licenses/>.
# --------------------------------------------------------------------

import libAsterGC
import numpy as np

from code_aster.Commands import *
from code_aster import CA

CA.init("--test")

test = CA.TestCase()

# values extracted from the first call to dintelu by ssll13d.comm
typco = 2
alphacc = 1.0000000000000000
ht = 0.50000000000000000
bw = 0.29999999999999999
enrobi = 4.0000000000000001e-002
enrobs = 4.0000000000000001e-002
facier = 500000000.00000000
fbeton = 35000000.000000000
gammas = 1.1499999999999999
gammac = 1.5000000000000000
clacier = 1
eys = 210000000000.00000
typdiag = 2
uc = 0
dnsinf = 0.0000000000000000
dnssup = 0.0000000000000000
ntot = 664
nrd_ref = [
    0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    0.0000000000000000,
    6763.7741046831916,
    25045.189504373175,
    51628.998830906567,
    83015.625000000000,
    115681.48148148147,
    148358.51851851848,
    181035.55555555556,
    208533.33333333334,
    234599.99999999991,
    260666.66666666663,
    286733.33333333326,
    312799.99999999988,
    338866.66666666669,
    364933.33333333331,
    391000.00000000000,
    417066.66666666669,
    443133.33333333331,
    469200.00000000000,
    495266.66666666651,
    521333.33333333326,
    547399.99999999988,
    573466.66666666651,
    599533.33333333337,
    625599.99999999988,
    651666.66666666663,
    677733.33333333337,
    703799.99999999988,
    729866.66666666663,
    755933.33333333326,
    782000.00000000000,
    808066.66666666651,
    834133.33333333337,
    860199.99999999977,
    886266.66666666686,
    912333.33333333337,
    938400.00000000000,
    964466.66666666651,
    990533.33333333302,
    1016599.9999999999,
    1042666.6666666667,
    1068733.3333333335,
    1094799.9999999998,
    1120866.6666666665,
    1146933.3333333330,
    1173000.0000000000,
    1199066.6666666667,
    1225133.3333333333,
    1251199.9999999998,
    1277266.6666666665,
    1303333.3333333333,
    1329399.9999999998,
    1355466.6666666665,
    1381533.3333333333,
    1407599.9999999998,
    1433666.6666666667,
    1459733.3333333333,
    1485800.0000000000,
    1511866.6666666665,
    1537933.3333333330,
    1563999.9999999995,
    1590066.6666666665,
    1616133.3333333330,
    1642199.9999999998,
    1668266.6666666667,
    1694333.3333333333,
    1720399.9999999995,
    1746466.6666666665,
    1772533.3333333333,
    1798599.9999999998,
    1824666.6666666667,
    1850733.3333333333,
    1876800.0000000000,
    1902866.6666666663,
    1928933.3333333330,
    1955000.0000000000,
    1981066.6666666660,
    2007133.3333333333,
    2033200.0000000002,
    2059266.6666666663,
    2085333.3333333335,
    2111399.9999999995,
    2137466.6666666670,
    2163533.3333333330,
    2189599.9999999995,
    2215666.6666666660,
    2241733.3333333330,
    2267799.9999999995,
    2293866.6666666660,
    2319933.3333333326,
    2346000.0000000000,
    2372066.6666666665,
    2398133.3333333335,
    2424199.9999999995,
    2450266.6666666665,
    2476333.3333333330,
    2502399.9999999995,
    2528466.6666666665,
    2554533.3333333330,
    2580599.9999999995,
    2606666.6666666665,
    2632733.3333333330,
    2658799.9999999995,
    2684866.6666666660,
    2710933.3333333330,
    2737000.0000000000,
    2763066.6666666670,
    2789133.3333333330,
    2815199.9999999995,
    2833333.3333333326,
    2833333.3333333330,
    2840930.6122448975,
    2848484.3537414963,
    2855994.5578231290,
    2863461.2244897955,
    2870884.3537414963,
    2878263.9455782310,
    2885599.9999999995,
    2892892.5170068028,
    2900141.4965986391,
    2907346.9387755101,
    2914508.8435374144,
    2921627.2108843536,
    2928702.0408163262,
    2935733.3333333330,
    2942721.0884353737,
    2949665.3061224488,
    2956565.9863945576,
    2963423.1292517004,
    2970236.7346938774,
    2977006.8027210878,
    2983733.3333333330,
    2990416.3265306121,
    2997055.7823129250,
    3003651.7006802717,
    3010204.0816326528,
    3016712.9251700677,
    3023178.2312925169,
    3029599.9999999995,
    3035978.2312925169,
    3042312.9251700677,
    3048604.0816326528,
    3054851.7006802717,
    3061055.7823129245,
    3067216.3265306121,
    3073333.3333333330,
    3079406.8027210878,
    3085436.7346938774,
    3091423.1292517004,
    3097365.9863945572,
    3103265.3061224483,
    3109121.0884353737,
    3114933.3333333330,
    3120702.0408163262,
    3126427.2108843531,
    3132108.8435374144,
    3137746.9387755096,
    3143341.4965986391,
    3148892.5170068024,
    3154399.9999999995,
    3159863.9455782310,
    3165284.3537414963,
    3170661.2244897955,
    3175994.5578231290,
    3181284.3537414963,
    3186530.6122448980,
    3191733.3333333330,
    3196892.5170068024,
    3202008.1632653060,
    3207080.2721088431,
    3212108.8435374144,
    3217093.8775510201,
    3222035.3741496592,
    3226933.3333333326,
    3231787.7551020402,
    3236598.6394557818,
    3241365.9863945572,
    3246089.7959183669,
    3250770.0680272104,
    3255406.8027210878,
    3260000.0000000000,
    3264549.6598639451,
    3269055.7823129250,
    3273518.3673469387,
    3277937.4149659858,
    3282312.9251700677,
    3286644.8979591834,
    3290933.3333333330,
    3295178.2312925169,
    3299379.5918367342,
    3303537.4149659858,
    3307651.7006802717,
    3311722.4489795910,
    3315749.6598639451,
    3319733.3333333326,
    3323673.4693877548,
    3327570.0680272104,
    3331423.1292517004,
    3335232.6530612241,
    3338998.6394557818,
    3342721.0884353737,
    3346399.9999999995,
    3350035.3741496592,
    3353627.2108843536,
    3357175.5102040810,
    3360680.2721088431,
    3364141.4965986391,
    3367559.1836734689,
    3370933.3333333326,
    3374263.9455782310,
    3377551.0204081628,
    3380794.5578231290,
    3383994.5578231285,
    3387151.0204081628,
    3390263.9455782305,
    3393333.3333333330,
    3396359.1836734689,
    3399341.4965986391,
    3402280.2721088431,
    3405175.5102040814,
    3408027.2108843531,
    3410835.3741496596,
    3413599.9999999995,
    3416321.0884353737,
    3418998.6394557818,
    3421632.6530612241,
    3424223.1292517004,
    3426770.0680272104,
    3429273.4693877548,
    3431733.3333333330,
    3434149.6598639451,
    3436522.4489795915,
    3438851.7006802717,
    3441137.4149659863,
    3443379.5918367342,
    3445578.2312925165,
    3447733.3333333330,
    3449844.8979591830,
    3451912.9251700677,
    3453937.4149659858,
    3455918.3673469382,
    3457855.7823129245,
    3459749.6598639451,
    3461599.9999999995,
    3463406.8027210883,
    3465170.0680272104,
    3466889.7959183669,
    3468565.9863945572,
    3470198.6394557818,
    3471787.7551020407,
    3473333.3333333330,
    3474835.3741496592,
    3476293.8775510201,
    3477708.8435374144,
    3479080.2721088431,
    3480408.1632653056,
    3481692.5170068019,
    3482933.3333333330,
    3484130.6122448975,
    3485284.3537414963,
    3486394.5578231285,
    3487461.2244897955,
    3488484.3537414963,
    3489463.9455782310,
    3490399.9999999995,
    3491292.5170068019,
    3492141.4965986391,
    3492946.9387755096,
    3493708.8435374144,
    3494427.2108843531,
    3495102.0408163262,
    3495733.3333333330,
    3496321.0884353737,
    3496865.3061224488,
    3497365.9863945572,
    3497823.1292517004,
    3498236.7346938769,
    3498606.8027210878,
    3498933.3333333330,
    3499216.3265306116,
    3499455.7823129245,
    3499651.7006802717,
    3499804.0816326528,
    3499912.9251700677,
    3499978.2312925165,
    3499999.9999999995,
    3499999.9999999995,
    3499978.2312925165,
    3499912.9251700677,
    3499804.0816326528,
    3499651.7006802717,
    3499455.7823129245,
    3499216.3265306116,
    3498933.3333333330,
    3498606.8027210878,
    3498236.7346938769,
    3497823.1292517004,
    3497365.9863945572,
    3496865.3061224488,
    3496321.0884353737,
    3495733.3333333330,
    3495102.0408163262,
    3494427.2108843531,
    3493708.8435374144,
    3492946.9387755096,
    3492141.4965986391,
    3491292.5170068019,
    3490399.9999999995,
    3489463.9455782310,
    3488484.3537414963,
    3487461.2244897955,
    3486394.5578231285,
    3485284.3537414963,
    3484130.6122448975,
    3482933.3333333330,
    3481692.5170068019,
    3480408.1632653056,
    3479080.2721088431,
    3477708.8435374144,
    3476293.8775510201,
    3474835.3741496592,
    3473333.3333333330,
    3471787.7551020407,
    3470198.6394557818,
    3468565.9863945572,
    3466889.7959183669,
    3465170.0680272104,
    3463406.8027210883,
    3461599.9999999995,
    3459749.6598639451,
    3457855.7823129245,
    3455918.3673469382,
    3453937.4149659858,
    3451912.9251700677,
    3449844.8979591830,
    3447733.3333333330,
    3445578.2312925165,
    3443379.5918367342,
    3441137.4149659863,
    3438851.7006802717,
    3436522.4489795915,
    3434149.6598639451,
    3431733.3333333330,
    3429273.4693877548,
    3426770.0680272104,
    3424223.1292517004,
    3421632.6530612241,
    3418998.6394557818,
    3416321.0884353737,
    3413599.9999999995,
    3410835.3741496596,
    3408027.2108843531,
    3405175.5102040814,
    3402280.2721088431,
    3399341.4965986391,
    3396359.1836734689,
    3393333.3333333330,
    3390263.9455782305,
    3387151.0204081628,
    3383994.5578231285,
    3380794.5578231290,
    3377551.0204081628,
    3374263.9455782310,
    3370933.3333333326,
    3367559.1836734689,
    3364141.4965986391,
    3360680.2721088431,
    3357175.5102040810,
    3353627.2108843536,
    3350035.3741496592,
    3346399.9999999995,
    3342721.0884353737,
    3338998.6394557818,
    3335232.6530612241,
    3331423.1292517004,
    3327570.0680272104,
    3323673.4693877548,
    3319733.3333333326,
    3315749.6598639451,
    3311722.4489795910,
    3307651.7006802717,
    3303537.4149659858,
    3299379.5918367342,
    3295178.2312925169,
    3290933.3333333330,
    3286644.8979591834,
    3282312.9251700677,
    3277937.4149659858,
    3273518.3673469387,
    3269055.7823129250,
    3264549.6598639451,
    3260000.0000000000,
    3255406.8027210878,
    3250770.0680272104,
    3246089.7959183669,
    3241365.9863945572,
    3236598.6394557818,
    3231787.7551020402,
    3226933.3333333326,
    3222035.3741496592,
    3217093.8775510201,
    3212108.8435374144,
    3207080.2721088431,
    3202008.1632653060,
    3196892.5170068024,
    3191733.3333333330,
    3186530.6122448980,
    3181284.3537414963,
    3175994.5578231290,
    3170661.2244897955,
    3165284.3537414963,
    3159863.9455782310,
    3154399.9999999995,
    3148892.5170068024,
    3143341.4965986391,
    3137746.9387755096,
    3132108.8435374144,
    3126427.2108843531,
    3120702.0408163262,
    3114933.3333333330,
    3109121.0884353737,
    3103265.3061224483,
    3097365.9863945572,
    3091423.1292517004,
    3085436.7346938774,
    3079406.8027210878,
    3073333.3333333330,
    3067216.3265306121,
    3061055.7823129245,
    3054851.7006802717,
    3048604.0816326528,
    3042312.9251700677,
    3035978.2312925169,
    3029599.9999999995,
    3023178.2312925169,
    3016712.9251700677,
    3010204.0816326528,
    3003651.7006802717,
    2997055.7823129250,
    2990416.3265306121,
    2983733.3333333330,
    2977006.8027210878,
    2970236.7346938774,
    2963423.1292517004,
    2956565.9863945576,
    2949665.3061224488,
    2942721.0884353737,
    2935733.3333333330,
    2928702.0408163262,
    2921627.2108843536,
    2914508.8435374144,
    2907346.9387755101,
    2900141.4965986391,
    2892892.5170068028,
    2885599.9999999995,
    2878263.9455782310,
    2870884.3537414963,
    2863461.2244897955,
    2855994.5578231290,
    2848484.3537414963,
    2840930.6122448975,
    2833333.3333333330,
    2833333.3333333326,
    2815199.9999999995,
    2789133.3333333330,
    2763066.6666666670,
    2737000.0000000000,
    2710933.3333333330,
    2684866.6666666660,
    2658799.9999999995,
    2632733.3333333330,
    2606666.6666666665,
    2580599.9999999995,
    2554533.3333333330,
    2528466.6666666665,
    2502399.9999999995,
    2476333.3333333330,
    2450266.6666666665,
    2424199.9999999995,
    2398133.3333333335,
    2372066.6666666665,
    2346000.0000000000,
    2319933.3333333326,
    2293866.6666666660,
    2267799.9999999995,
    2241733.3333333330,
    2215666.6666666660,
    2189599.9999999995,
    2163533.3333333330,
    2137466.6666666670,
    2111399.9999999995,
    2085333.3333333335,
    2059266.6666666663,
    2033200.0000000002,
    2007133.3333333333,
    1981066.6666666660,
    1955000.0000000000,
    1928933.3333333330,
    1902866.6666666663,
    1876800.0000000000,
    1850733.3333333333,
    1824666.6666666667,
    1798599.9999999998,
    1772533.3333333333,
    1746466.6666666665,
    1720399.9999999995,
    1694333.3333333333,
    1668266.6666666667,
    1642199.9999999998,
    1616133.3333333330,
    1590066.6666666665,
    1563999.9999999995,
    1537933.3333333330,
    1511866.6666666665,
    1485800.0000000000,
    1459733.3333333333,
    1433666.6666666667,
    1407599.9999999998,
    1381533.3333333333,
    1355466.6666666665,
    1329399.9999999998,
    1303333.3333333333,
    1277266.6666666665,
    1251199.9999999998,
    1225133.3333333333,
    1199066.6666666667,
    1173000.0000000000,
    1146933.3333333330,
    1120866.6666666665,
    1094799.9999999998,
    1068733.3333333335,
    1042666.6666666667,
    1016599.9999999999,
    990533.33333333302,
    964466.66666666651,
    938400.00000000000,
    912333.33333333337,
    886266.66666666686,
    860199.99999999977,
    834133.33333333337,
    808066.66666666651,
    782000.00000000000,
    755933.33333333326,
    729866.66666666663,
    703799.99999999988,
    677733.33333333337,
    651666.66666666663,
    625599.99999999988,
    599533.33333333337,
    573466.66666666651,
    547399.99999999988,
    521333.33333333326,
    495266.66666666651,
    469200.00000000000,
    443133.33333333331,
    417066.66666666669,
    391000.00000000000,
    364933.33333333331,
    338866.66666666669,
    312799.99999999988,
    286733.33333333326,
    260666.66666666663,
    234599.99999999991,
    208533.33333333334,
    181035.55555555556,
    148358.51851851848,
    115681.48148148147,
    83015.625000000000,
    51628.998830906567,
    25045.189504373175,
    6763.7741046831916,
    0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
    -0.0000000000000000,
]
mrd_ref = [
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    1680.3598829201101,
    6181.0220116618075,
    12651.824764852799,
    20186.884375000005,
    27891.149711934166,
    35445.656111934164,
    42847.605007407416,
    48941.196190476199,
    54609.951428571425,
    60178.952380952396,
    65648.199047619040,
    71017.691428571430,
    76287.429523809522,
    81457.413333333345,
    86527.642857142870,
    91498.118095238096,
    96368.839047619054,
    101139.80571428574,
    105811.01809523813,
    110382.47619047623,
    114854.18000000001,
    119226.12952380952,
    123498.32476190479,
    127670.76571428572,
    131743.45238095240,
    135716.38476190477,
    139589.56285714288,
    143362.98666666669,
    147036.65619047618,
    150610.57142857142,
    154084.73238095237,
    157459.13904761907,
    160733.79142857142,
    163908.68952380959,
    166983.83333333334,
    169959.22285714289,
    172834.85809523813,
    175610.73904761905,
    178286.86571428576,
    180863.23809523808,
    183339.85619047625,
    185716.72000000000,
    187993.82952380960,
    190171.18476190485,
    192248.78571428574,
    194226.63238095242,
    196104.72476190477,
    197883.06285714288,
    199561.64666666670,
    201140.47619047618,
    202619.55142857146,
    203998.87238095244,
    205278.43904761906,
    206458.25142857144,
    207538.30952380950,
    208518.61333333337,
    209399.16285714286,
    210179.95809523814,
    210860.99904761909,
    211442.28571428574,
    211923.81809523806,
    212305.59619047618,
    212587.61999999997,
    212769.88952380954,
    212852.40476190473,
    212835.16571428574,
    212718.17238095240,
    212501.42476190481,
    212184.92285714284,
    211768.66666666666,
    211252.65619047621,
    210636.89142857143,
    209921.37238095241,
    209106.09904761909,
    208191.07142857145,
    207176.28952380957,
    206061.75333333330,
    204847.46285714285,
    203533.41809523813,
    202119.61904761902,
    200606.06571428571,
    198992.75809523807,
    197279.69619047621,
    195466.88000000003,
    193554.30952380953,
    191541.98476190475,
    189429.90571428573,
    187218.07238095239,
    184906.48476190481,
    182495.14285714287,
    179984.04666666666,
    177373.19619047610,
    174662.59142857141,
    171852.23238095231,
    168942.11904761902,
    165932.25142857144,
    162822.62952380948,
    159613.25333333330,
    156304.12285714288,
    152895.23809523808,
    149386.59904761901,
    145778.20571428572,
    142070.05809523808,
    138262.15619047618,
    134354.49999999997,
    130347.08952380947,
    126239.92476190469,
    122033.00571428565,
    119047.61904761904,
    119047.61904761902,
    117690.96209912535,
    116342.07968901844,
    115000.97181729831,
    113667.63848396498,
    112342.07968901843,
    111024.29543245866,
    109714.28571428568,
    108412.05053449949,
    107117.58989310007,
    105830.90379008742,
    104551.99222546158,
    103280.85519922253,
    102017.49271137026,
    100761.90476190475,
    99514.091350826042,
    98274.052478134094,
    97041.788143828962,
    95817.298347910575,
    94600.583090379005,
    93391.642371234208,
    92190.476190476169,
    90997.084548104933,
    89811.467444120484,
    88633.624878522824,
    87463.556851311936,
    86301.263362487836,
    85146.744412050510,
    83999.999999999971,
    82861.030126336220,
    81729.834791059271,
    80606.413994169081,
    79490.767735665664,
    78382.896015549064,
    77282.798833819223,
    76190.476190476169,
    75105.928085519903,
    74029.154518950410,
    72960.155490767735,
    71898.931000971817,
    70845.481049562673,
    69799.805636540332,
    68761.904761904749,
    67731.778425655968,
    66709.426627793975,
    65694.849368318755,
    64688.046647230316,
    63689.018464528657,
    62697.764820213786,
    61714.285714285710,
    60738.581146744400,
    59770.651117589885,
    58810.495626822143,
    57858.114674441189,
    56913.508260447023,
    55976.676384839637,
    55047.619047619031,
    54126.336248785214,
    53212.827988338177,
    52307.094266277927,
    51409.135082604451,
    50518.950437317770,
    49636.540330417862,
    48761.904761904756,
    47895.043731778424,
    47035.957240038872,
    46184.645286686100,
    45341.107871720109,
    44505.344995140906,
    43677.356656948490,
    42857.142857142848,
    42044.703595724000,
    41240.038872691926,
    40443.148688046640,
    39654.033041788134,
    38872.691933916416,
    38099.125364431478,
    37333.333333333321,
    36575.315840621952,
    35825.072886297370,
    35082.604470359562,
    34347.910592808541,
    33620.991253644315,
    32901.846452866856,
    32190.476190476187,
    31486.880466472299,
    30791.059280855196,
    30103.012633624872,
    29422.740524781337,
    28750.242954324578,
    28085.519922254607,
    27428.571428571420,
    26779.397473275018,
    26137.998056365395,
    25504.373177842564,
    24878.522837706510,
    24260.447035957241,
    23650.145772594751,
    23047.619047619042,
    22452.866861030121,
    21865.889212827984,
    21286.686103012627,
    20715.257531584055,
    20151.603498542270,
    19595.724003887266,
    19047.619047619042,
    18507.288629737603,
    17974.732750242954,
    17449.951409135083,
    16932.944606413992,
    16423.712342079689,
    15922.254616132164,
    15428.571428571428,
    14942.662779397471,
    14464.528668610297,
    13994.169096209909,
    13531.584062196303,
    13076.773566569482,
    12629.737609329442,
    12190.476190476189,
    11758.989310009718,
    11335.276967930027,
    10919.339164237123,
    10511.175898931000,
    10110.787172011660,
    9718.1729834791040,
    9333.3333333333303,
    8956.2682215743425,
    8586.9776482021352,
    8225.4616132167139,
    7871.7201166180748,
    7525.7531584062181,
    7187.5607385811445,
    6857.1428571428551,
    6534.4995140913488,
    6219.6307094266276,
    5912.5364431486878,
    5613.2167152575303,
    5321.6715257531569,
    5037.9008746355676,
    4761.9047619047606,
    4493.6831875607386,
    4233.2361516034980,
    3980.5636540330411,
    3735.6656948493678,
    3498.5422740524773,
    3269.1933916423704,
    3047.6190476190473,
    2833.8192419825068,
    2627.7939747327500,
    2429.5432458697760,
    2239.0670553935856,
    2056.3654033041785,
    1881.4382896015545,
    1714.2857142857138,
    1554.9076773566569,
    1403.3041788143826,
    1259.4752186588919,
    1123.4207968901846,
    995.14091350826027,
    874.63556851311932,
    761.90476190476181,
    656.94849368318751,
    559.76676384839641,
    470.35957240038863,
    388.72691933916423,
    314.86880466472297,
    248.78522837706507,
    190.47619047619045,
    139.94169096209910,
    97.181729834791057,
    62.196307094266267,
    34.985422740524776,
    15.549076773566567,
    3.8872691933916417,
    0.0000000000000000,
    0.0000000000000000,
    -3.8872691933916417,
    -15.549076773566567,
    -34.985422740524776,
    -62.196307094266267,
    -97.181729834791057,
    -139.94169096209910,
    -190.47619047619045,
    -248.78522837706507,
    -314.86880466472297,
    -388.72691933916423,
    -470.35957240038863,
    -559.76676384839641,
    -656.94849368318751,
    -761.90476190476181,
    -874.63556851311932,
    -995.14091350826027,
    -1123.4207968901846,
    -1259.4752186588919,
    -1403.3041788143826,
    -1554.9076773566569,
    -1714.2857142857138,
    -1881.4382896015545,
    -2056.3654033041785,
    -2239.0670553935856,
    -2429.5432458697760,
    -2627.7939747327500,
    -2833.8192419825068,
    -3047.6190476190473,
    -3269.1933916423704,
    -3498.5422740524773,
    -3735.6656948493678,
    -3980.5636540330411,
    -4233.2361516034980,
    -4493.6831875607386,
    -4761.9047619047606,
    -5037.9008746355676,
    -5321.6715257531569,
    -5613.2167152575303,
    -5912.5364431486878,
    -6219.6307094266276,
    -6534.4995140913488,
    -6857.1428571428551,
    -7187.5607385811445,
    -7525.7531584062181,
    -7871.7201166180748,
    -8225.4616132167139,
    -8586.9776482021352,
    -8956.2682215743425,
    -9333.3333333333303,
    -9718.1729834791040,
    -10110.787172011660,
    -10511.175898931000,
    -10919.339164237123,
    -11335.276967930027,
    -11758.989310009718,
    -12190.476190476189,
    -12629.737609329442,
    -13076.773566569482,
    -13531.584062196303,
    -13994.169096209909,
    -14464.528668610297,
    -14942.662779397471,
    -15428.571428571428,
    -15922.254616132164,
    -16423.712342079689,
    -16932.944606413992,
    -17449.951409135083,
    -17974.732750242954,
    -18507.288629737603,
    -19047.619047619042,
    -19595.724003887266,
    -20151.603498542270,
    -20715.257531584055,
    -21286.686103012627,
    -21865.889212827984,
    -22452.866861030121,
    -23047.619047619042,
    -23650.145772594751,
    -24260.447035957241,
    -24878.522837706510,
    -25504.373177842564,
    -26137.998056365395,
    -26779.397473275018,
    -27428.571428571420,
    -28085.519922254607,
    -28750.242954324578,
    -29422.740524781337,
    -30103.012633624872,
    -30791.059280855196,
    -31486.880466472299,
    -32190.476190476187,
    -32901.846452866856,
    -33620.991253644315,
    -34347.910592808541,
    -35082.604470359562,
    -35825.072886297370,
    -36575.315840621952,
    -37333.333333333321,
    -38099.125364431478,
    -38872.691933916416,
    -39654.033041788134,
    -40443.148688046640,
    -41240.038872691926,
    -42044.703595724000,
    -42857.142857142848,
    -43677.356656948490,
    -44505.344995140906,
    -45341.107871720109,
    -46184.645286686100,
    -47035.957240038872,
    -47895.043731778424,
    -48761.904761904756,
    -49636.540330417862,
    -50518.950437317770,
    -51409.135082604451,
    -52307.094266277927,
    -53212.827988338177,
    -54126.336248785214,
    -55047.619047619031,
    -55976.676384839637,
    -56913.508260447023,
    -57858.114674441189,
    -58810.495626822143,
    -59770.651117589885,
    -60738.581146744400,
    -61714.285714285710,
    -62697.764820213786,
    -63689.018464528657,
    -64688.046647230316,
    -65694.849368318755,
    -66709.426627793975,
    -67731.778425655968,
    -68761.904761904749,
    -69799.805636540332,
    -70845.481049562673,
    -71898.931000971817,
    -72960.155490767735,
    -74029.154518950410,
    -75105.928085519903,
    -76190.476190476169,
    -77282.798833819223,
    -78382.896015549064,
    -79490.767735665664,
    -80606.413994169081,
    -81729.834791059271,
    -82861.030126336220,
    -83999.999999999971,
    -85146.744412050510,
    -86301.263362487836,
    -87463.556851311936,
    -88633.624878522824,
    -89811.467444120484,
    -90997.084548104933,
    -92190.476190476169,
    -93391.642371234208,
    -94600.583090379005,
    -95817.298347910575,
    -97041.788143828962,
    -98274.052478134094,
    -99514.091350826042,
    -100761.90476190475,
    -102017.49271137026,
    -103280.85519922253,
    -104551.99222546158,
    -105830.90379008742,
    -107117.58989310007,
    -108412.05053449949,
    -109714.28571428568,
    -111024.29543245866,
    -112342.07968901843,
    -113667.63848396498,
    -115000.97181729831,
    -116342.07968901844,
    -117690.96209912535,
    -119047.61904761902,
    -119047.61904761904,
    -122033.00571428565,
    -126239.92476190469,
    -130347.08952380947,
    -134354.49999999997,
    -138262.15619047618,
    -142070.05809523808,
    -145778.20571428572,
    -149386.59904761901,
    -152895.23809523808,
    -156304.12285714288,
    -159613.25333333330,
    -162822.62952380948,
    -165932.25142857144,
    -168942.11904761902,
    -171852.23238095231,
    -174662.59142857141,
    -177373.19619047610,
    -179984.04666666666,
    -182495.14285714287,
    -184906.48476190481,
    -187218.07238095239,
    -189429.90571428573,
    -191541.98476190475,
    -193554.30952380953,
    -195466.88000000003,
    -197279.69619047621,
    -198992.75809523807,
    -200606.06571428571,
    -202119.61904761902,
    -203533.41809523813,
    -204847.46285714285,
    -206061.75333333330,
    -207176.28952380957,
    -208191.07142857145,
    -209106.09904761909,
    -209921.37238095241,
    -210636.89142857143,
    -211252.65619047621,
    -211768.66666666666,
    -212184.92285714284,
    -212501.42476190481,
    -212718.17238095240,
    -212835.16571428574,
    -212852.40476190473,
    -212769.88952380954,
    -212587.61999999997,
    -212305.59619047618,
    -211923.81809523806,
    -211442.28571428574,
    -210860.99904761909,
    -210179.95809523814,
    -209399.16285714286,
    -208518.61333333337,
    -207538.30952380950,
    -206458.25142857144,
    -205278.43904761906,
    -203998.87238095244,
    -202619.55142857146,
    -201140.47619047618,
    -199561.64666666670,
    -197883.06285714288,
    -196104.72476190477,
    -194226.63238095242,
    -192248.78571428574,
    -190171.18476190485,
    -187993.82952380960,
    -185716.72000000000,
    -183339.85619047625,
    -180863.23809523808,
    -178286.86571428576,
    -175610.73904761905,
    -172834.85809523813,
    -169959.22285714289,
    -166983.83333333334,
    -163908.68952380959,
    -160733.79142857142,
    -157459.13904761907,
    -154084.73238095237,
    -150610.57142857142,
    -147036.65619047618,
    -143362.98666666669,
    -139589.56285714288,
    -135716.38476190477,
    -131743.45238095240,
    -127670.76571428572,
    -123498.32476190479,
    -119226.12952380952,
    -114854.18000000001,
    -110382.47619047623,
    -105811.01809523813,
    -101139.80571428574,
    -96368.839047619054,
    -91498.118095238096,
    -86527.642857142870,
    -81457.413333333345,
    -76287.429523809522,
    -71017.691428571430,
    -65648.199047619040,
    -60178.952380952396,
    -54609.951428571425,
    -48941.196190476199,
    -42847.605007407416,
    -35445.656111934164,
    -27891.149711934166,
    -20186.884375000005,
    -12651.824764852799,
    -6181.0220116618075,
    -1680.3598829201101,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
    0.0000000000000000,
]


test.assertEqual(len(nrd_ref), ntot, msg="size of nrd ref")
test.assertEqual(len(mrd_ref), ntot, msg="size of mrd ref")

nrd, mrd = libAsterGC.dintelu(
    typco,
    alphacc,
    ht,
    bw,
    enrobi,
    enrobs,
    facier,
    fbeton,
    gammas,
    gammac,
    clacier,
    eys,
    typdiag,
    uc,
    dnsinf,
    dnssup,
)
# print(f"returned: {nrd=}, {mrd=}")
test.assertEqual(len(nrd), ntot, msg="size of nrd")
test.assertEqual(len(mrd), ntot, msg="size of mrd")

nrd = np.array(nrd)
mrd = np.array(mrd)

nrd_diff = abs(nrd_ref - nrd)
test.assertLessEqual(nrd_diff.max(), 1.0e-6, msg="diff nrd")
mrd_diff = abs(mrd_ref - mrd)
test.assertLessEqual(mrd_diff.max(), 1.0e-6, msg="diff mrd")

test.printSummary()

CA.close()
