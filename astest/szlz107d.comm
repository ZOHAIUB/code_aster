# coding=utf-8
# --------------------------------------------------------------------
# Copyright (C) 1991 - 2025 - EDF R&D - www.code-aster.org
# This file is part of code_aster.
#
# code_aster is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# code_aster is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with code_aster.  If not, see <http://www.gnu.org/licenses/>.
# --------------------------------------------------------------------

DEBUT(CODE="OUI", ERREUR=_F(ALARME="EXCEPTION"), DEBUG=_F(SDVERI="OUI"))

# LE CHARGEMENT OBTENU AVEC SSLV135f


MANCOF = DEFI_FONCTION(
    NOM_PARA="EPSI",
    INTERPOL="LOG",
    PROL_DROITE="LINEAIRE",
    PROL_GAUCHE="LINEAIRE",
    VALE=(
        0.00226,
        5800000.0,
        0.00230,
        4600000.0,
        0.00250,
        239284.0,
        0.00270,
        149535.0,
        0.00300,
        73544.0,
        0.00350,
        33821.0,
        0.00600,
        2850.0,
        0.00850,
        1068.0,
        0.01000,
        562.0,
        1.00000,
        1.0,
    ),
)
MAT0 = DEFI_MATERIAU(ELAS=_F(E=200000.0, NU=0.3, ALPHA=0.0), FATIGUE=_F(MANSON_COFFIN=MANCOF))


MANCO1 = FORMULE(NOM_PARA=("NBRUP"), VALE=""" 0.022524751*(NBRUP**(-0.1619)) """)

## CRITERE A TESTER
CRIT = [None] * 4
CRIT[0] = FORMULE(NOM_PARA=("EPSN1_1", "EPSN1_2"), VALE="""abs((EPSN1_1-EPSN1_2)/2)""")

CRIT[1] = FORMULE(NOM_PARA=("ETPR1_1", "ETPR1_2"), VALE="""abs((ETPR1_1-ETPR1_2)/2)""")

CRIT[2] = FORMULE(NOM_PARA=("ETEQ_1", "ETEQ_2"), VALE="""abs((ETEQ_1-ETEQ_2)/2)""")

CRIT[3] = FORMULE(NOM_PARA=("EPPR1_1", "EPPR1_2"), VALE="""abs((EPPR1_2-EPPR1_1)/2)""")

#######################################################
# ASSOCIE AVEC LA SOLUTION SOL_NL de SSLV135f
#######################################################
SIGMXX = DEFI_FONCTION(
    NOM_PARA="INST",
    VALE=(
        0.00000e00,
        0.00000e00,
        2.50000e-01,
        3.00000e02,
        5.00000e-01,
        6.00000e02,
        7.50000e-01,
        9.00000e02,
        1.00000e00,
        1.20000e03,
        1.25000e00,
        9.00000e02,
        1.50000e00,
        6.00000e02,
        1.75000e00,
        3.00000e02,
        2.00000e00,
        1.59763e-13,
        2.25000e00,
        3.00000e02,
        2.50000e00,
        6.00000e02,
        2.75000e00,
        9.00000e02,
        3.00000e00,
        6.00000e02,
        3.25000e00,
        3.00000e02,
        3.50000e00,
        6.55196e-26,
    ),
)

SIGMYY = DEFI_FONCTION(
    NOM_PARA="INST",
    VALE=(
        0.00000e00,
        0.00000e00,
        2.50000e-01,
        -1.50000e02,
        5.00000e-01,
        -3.00000e02,
        7.50000e-01,
        -4.50000e02,
        1.00000e00,
        -6.00000e02,
        1.25000e00,
        -4.50000e02,
        1.50000e00,
        -3.00000e02,
        1.75000e00,
        -1.50000e02,
        2.00000e00,
        -4.85545e-13,
        2.25000e00,
        -1.50000e02,
        2.50000e00,
        -3.00000e02,
        2.75000e00,
        -4.50000e02,
        3.00000e00,
        -3.00000e02,
        3.25000e00,
        -1.50000e02,
        3.50000e00,
        6.54640e-26,
    ),
)
ZERO = DEFI_FONCTION(
    NOM_PARA="INST",
    VALE=(
        0.00000e00,
        0,
        2.50000e-01,
        0,
        5.00000e-01,
        0,
        7.50000e-01,
        0,
        1.00000e00,
        0,
        1.25000e00,
        0,
        1.50000e00,
        0,
        1.75000e00,
        0,
        2.00000e00,
        0,
        2.25000e00,
        0,
        2.50000e00,
        0,
        2.75000e00,
        0,
        3.00000e00,
        0,
        3.25000e00,
        0,
        3.50000e00,
        0,
    ),
)

EPSTXX = DEFI_FONCTION(
    NOM_PARA="INST",
    VALE=(
        0.00000e00,
        0.00000e00,
        2.50000e-01,
        1.72500e-03,
        5.00000e-01,
        3.45000e-03,
        7.50000e-01,
        5.17500e-03,
        1.00000e00,
        6.90000e-03,
        1.25000e00,
        5.17500e-03,
        1.50000e00,
        3.45000e-03,
        1.75000e00,
        1.72500e-03,
        2.00000e00,
        1.59242e-18,
        2.25000e00,
        1.72500e-03,
        2.50000e00,
        3.45000e-03,
        2.75000e00,
        5.17500e-03,
        3.00000e00,
        3.45000e-03,
        3.25000e00,
        1.72500e-03,
        3.50000e00,
        -8.11298e-33,
    ),
)


EPSTYY = DEFI_FONCTION(
    NOM_PARA="INST",
    VALE=(
        0.00000e00,
        0.00000e00,
        2.50000e-01,
        -1.20000e-03,
        5.00000e-01,
        -2.40000e-03,
        7.50000e-01,
        -3.60000e-03,
        1.00000e00,
        -4.80000e-03,
        1.25000e00,
        -3.60000e-03,
        1.50000e00,
        -2.40000e-03,
        1.75000e00,
        -1.20000e-03,
        2.00000e00,
        -2.60209e-18,
        2.25000e00,
        -1.20000e-03,
        2.50000e00,
        -2.40000e-03,
        2.75000e00,
        -3.60000e-03,
        3.00000e00,
        -2.40000e-03,
        3.25000e00,
        -1.20000e-03,
        3.50000e00,
        -1.00148e-32,
    ),
)

EPSTZZ = DEFI_FONCTION(
    NOM_PARA="INST",
    VALE=(
        0.00000e00,
        0.00000e00,
        2.50000e-01,
        -2.25000e-04,
        5.00000e-01,
        -4.50000e-04,
        7.50000e-01,
        -6.75000e-04,
        1.00000e00,
        -9.00000e-04,
        1.25000e00,
        -6.75000e-04,
        1.50000e00,
        -4.50000e-04,
        1.75000e00,
        -2.25000e-04,
        2.00000e00,
        2.71051e-19,
        2.25000e00,
        -2.25000e-04,
        2.50000e00,
        -4.50000e-04,
        2.75000e00,
        -6.75000e-04,
        3.00000e00,
        -4.50000e-04,
        3.25000e00,
        -2.25000e-04,
        3.50000e00,
        1.84889e-32,
    ),
)

## -----------------------------------------------------------------------

NBPR = 4

FATN = [None] * (NBPR - 1)
FATNW = [None] * (NBPR - 1)
FATNF = [None] * (NBPR - 1)
RESU = [3.26558685783619e-5, 3.26558685783619e-5, 3.21404432462201e-5]
RESUC = [3.2655868578362e-5, 3.2655868578362e-5, 3.2140443246219e-5]

RESUF = [1.08363973045249e-5, 1.08363973045249e-5, 1.0633842276096e-5]
RESUFC = [1.0836397494616e-5, 1.0836397494616e-5, 1.0633842276096e-5]

for i in range(NBPR - 1):

    FATN[i] = POST_FATIGUE(
        CHARGEMENT="MULTIAXIAL",
        HISTOIRE=_F(
            SIGM_XX=SIGMXX,
            SIGM_YY=SIGMYY,
            SIGM_ZZ=ZERO,
            SIGM_XY=ZERO,
            SIGM_XZ=ZERO,
            SIGM_YZ=ZERO,
            EPS_XX=EPSTXX,
            EPS_YY=EPSTYY,
            EPS_ZZ=EPSTZZ,
            EPS_XY=ZERO,
            EPS_XZ=ZERO,
            EPS_YZ=ZERO,
        ),
        TYPE_CHARGE="NON_PERIODIQUE",
        CRITERE="FORMULE_CRITERE",
        FORMULE_GRDEQ=CRIT[i],
        DOMMAGE="MANSON_COFFIN",
        MATER=MAT0,
        PROJECTION="UN_AXE",
    )

    IMPR_TABLE(TABLE=FATN[i])

    TEST_TABLE(
        TABLE=FATN[i],
        NOM_PARA="DOMMAGE",
        VALE_REFE=RESU[i],
        VALE_CALC=RESUC[i],
        PRECISION=1.0e-4,
        REFERENCE="ANALYTIQUE",
    )

for i in range(NBPR - 2):

    FATNW[i] = POST_FATIGUE(
        CHARGEMENT="MULTIAXIAL",
        HISTOIRE=_F(
            SIGM_XX=SIGMXX,
            SIGM_YY=SIGMYY,
            SIGM_ZZ=ZERO,
            SIGM_XY=ZERO,
            SIGM_XZ=ZERO,
            SIGM_YZ=ZERO,
            EPS_XX=EPSTXX,
            EPS_YY=EPSTYY,
            EPS_ZZ=EPSTZZ,
            EPS_XY=ZERO,
            EPS_XZ=ZERO,
            EPS_YZ=ZERO,
        ),
        TYPE_CHARGE="NON_PERIODIQUE",
        CRITERE="FORMULE_CRITERE",
        FORMULE_GRDEQ=CRIT[i],
        DOMMAGE="FORM_VIE",
        FORMULE_VIE=MANCOF,
        MATER=MAT0,
        PROJECTION="UN_AXE",
    )

    IMPR_TABLE(TABLE=FATNW[i])

    TEST_TABLE(
        TABLE=FATNW[i],
        NOM_PARA="DOMMAGE",
        VALE_REFE=RESU[i],
        VALE_CALC=RESUC[i],
        REFERENCE="ANALYTIQUE",
        PRECISION=2.5e-3,
    )

for i in range(NBPR - 2):

    FATNF[i] = POST_FATIGUE(
        CHARGEMENT="MULTIAXIAL",
        HISTOIRE=_F(
            SIGM_XX=SIGMXX,
            SIGM_YY=SIGMYY,
            SIGM_ZZ=ZERO,
            SIGM_XY=ZERO,
            SIGM_XZ=ZERO,
            SIGM_YZ=ZERO,
            EPS_XX=EPSTXX,
            EPS_YY=EPSTYY,
            EPS_ZZ=EPSTZZ,
            EPS_XY=ZERO,
            EPS_XZ=ZERO,
            EPS_YZ=ZERO,
        ),
        TYPE_CHARGE="NON_PERIODIQUE",
        CRITERE="FORMULE_CRITERE",
        FORMULE_GRDEQ=CRIT[i],
        DOMMAGE="FORM_VIE",
        FORMULE_VIE=MANCO1,
        MATER=MAT0,
        PROJECTION="UN_AXE",
    )

    IMPR_TABLE(TABLE=FATNF[i])

    TEST_TABLE(
        TABLE=FATNF[i],
        NOM_PARA="DOMMAGE",
        VALE_REFE=RESUF[i],
        VALE_CALC=RESUFC[i],
        REFERENCE="ANALYTIQUE",
        PRECISION=1.0e-5,
    )


#######################################################
# ASSOCIE AVEC LA SOLUTION SOL_NL2 de SSLV135f
#######################################################
SIGMXX2 = DEFI_FONCTION(
    NOM_PARA="INST",
    VALE=(
        0.00000e00,
        0.00000e00,
        1.00000e-01,
        1.20000e02,
        2.00000e-01,
        2.40000e02,
        3.00000e-01,
        3.60000e02,
        4.00000e-01,
        4.80000e02,
        5.00000e-01,
        6.00000e02,
        6.00000e-01,
        7.20000e02,
        7.00000e-01,
        8.40000e02,
        8.00000e-01,
        9.60000e02,
        9.00000e-01,
        1.08000e03,
        1.00000e00,
        1.20000e03,
        1.10000e00,
        1.08000e03,
        1.20000e00,
        9.60000e02,
        1.30000e00,
        8.40000e02,
        1.40000e00,
        7.20000e02,
        1.50000e00,
        6.00000e02,
        1.60000e00,
        4.80000e02,
        1.70000e00,
        3.60000e02,
        1.80000e00,
        2.40000e02,
        1.90000e00,
        1.20000e02,
        2.00000e00,
        -9.32604e-15,
        2.10000e00,
        -1.20000e02,
        2.20000e00,
        -2.40000e02,
        2.30000e00,
        -3.60000e02,
        2.40000e00,
        -4.80000e02,
        2.50000e00,
        -6.00000e02,
        2.51250e00,
        -6.15000e02,
        2.52500e00,
        -6.30000e02,
        2.53750e00,
        -6.45000e02,
        2.55000e00,
        -6.60000e02,
        2.56250e00,
        -6.75000e02,
        2.66250e00,
        -5.17500e02,
        2.76250e00,
        -3.60000e02,
        2.86250e00,
        -2.02500e02,
        2.96250e00,
        -4.50000e01,
        3.06250e00,
        1.12500e02,
        3.16250e00,
        2.70000e02,
        3.26250e00,
        4.27500e02,
        3.36250e00,
        5.85000e02,
        3.46250e00,
        7.42500e02,
        3.56250e00,
        9.00000e02,
        3.66250e00,
        7.42500e02,
        3.76250e00,
        5.85000e02,
        3.86250e00,
        4.27500e02,
        3.96250e00,
        2.70000e02,
        4.06250e00,
        1.12500e02,
        4.16250e00,
        -4.50000e01,
        4.26250e00,
        -2.02500e02,
        4.36250e00,
        -3.60000e02,
        4.46250e00,
        -5.17500e02,
        4.56250e00,
        -6.75000e02,
    ),
)

ZERO2 = DEFI_FONCTION(
    NOM_PARA="INST",
    VALE=(
        0.00000e00,
        0,
        1.00000e-01,
        0,
        2.00000e-01,
        0,
        3.00000e-01,
        0,
        4.00000e-01,
        0,
        5.00000e-01,
        0,
        6.00000e-01,
        0,
        7.00000e-01,
        0,
        8.00000e-01,
        0,
        9.00000e-01,
        0,
        1.00000e00,
        0,
        1.10000e00,
        0,
        1.20000e00,
        0,
        1.30000e00,
        0,
        1.40000e00,
        0,
        1.50000e00,
        0,
        1.60000e00,
        0,
        1.70000e00,
        0,
        1.80000e00,
        0,
        1.90000e00,
        0,
        2.00000e00,
        0,
        2.10000e00,
        0,
        2.20000e00,
        0,
        2.30000e00,
        0,
        2.40000e00,
        0,
        2.50000e00,
        0,
        2.51250e00,
        0,
        2.52500e00,
        0,
        2.53750e00,
        0,
        2.55000e00,
        0,
        2.56250e00,
        0,
        2.66250e00,
        0,
        2.76250e00,
        0,
        2.86250e00,
        0,
        2.96250e00,
        0,
        3.06250e00,
        0,
        3.16250e00,
        0,
        3.26250e00,
        0,
        3.36250e00,
        0,
        3.46250e00,
        0,
        3.56250e00,
        0,
        3.66250e00,
        0,
        3.76250e00,
        0,
        3.86250e00,
        0,
        3.96250e00,
        0,
        4.06250e00,
        0,
        4.16250e00,
        0,
        4.26250e00,
        0,
        4.36250e00,
        0,
        4.46250e00,
        0,
        4.56250e00,
        0,
    ),
)

EPSTXX2 = DEFI_FONCTION(
    NOM_PARA="INST",
    VALE=(
        0.00000e00,
        0.00000e00,
        1.00000e-01,
        6.00000e-04,
        2.00000e-01,
        1.20000e-03,
        3.00000e-01,
        1.80000e-03,
        4.00000e-01,
        2.40000e-03,
        5.00000e-01,
        3.00000e-03,
        6.00000e-01,
        3.60000e-03,
        7.00000e-01,
        4.20000e-03,
        8.00000e-01,
        5.70000e-03,
        9.00000e-01,
        8.10000e-03,
        1.00000e00,
        1.05000e-02,
        1.10000e00,
        9.90000e-03,
        1.20000e00,
        9.30000e-03,
        1.30000e00,
        8.70000e-03,
        1.40000e00,
        8.10000e-03,
        1.50000e00,
        7.50000e-03,
        1.60000e00,
        6.90000e-03,
        1.70000e00,
        6.30000e-03,
        1.80000e00,
        5.70000e-03,
        1.90000e00,
        5.10000e-03,
        2.00000e00,
        4.50000e-03,
        2.10000e00,
        3.90000e-03,
        2.20000e00,
        3.30000e-03,
        2.30000e00,
        2.70000e-03,
        2.40000e00,
        2.10000e-03,
        2.50000e00,
        1.50000e-03,
        2.51250e00,
        1.20000e-03,
        2.52500e00,
        9.00000e-04,
        2.53750e00,
        6.00000e-04,
        2.55000e00,
        3.00000e-04,
        2.56250e00,
        -3.17852e-13,
        2.66250e00,
        7.87500e-04,
        2.76250e00,
        1.57500e-03,
        2.86250e00,
        2.36250e-03,
        2.96250e00,
        3.15000e-03,
        3.06250e00,
        3.93750e-03,
        3.16250e00,
        4.72500e-03,
        3.26250e00,
        5.51250e-03,
        3.36250e00,
        6.30000e-03,
        3.46250e00,
        7.08750e-03,
        3.56250e00,
        7.87500e-03,
        3.66250e00,
        7.08750e-03,
        3.76250e00,
        6.30000e-03,
        3.86250e00,
        5.51250e-03,
        3.96250e00,
        4.72500e-03,
        4.06250e00,
        3.93750e-03,
        4.16250e00,
        3.15000e-03,
        4.26250e00,
        2.36250e-03,
        4.36250e00,
        1.57500e-03,
        4.46250e00,
        7.87500e-04,
        4.56250e00,
        -3.17962e-13,
    ),
)


EPSTYY2 = DEFI_FONCTION(
    NOM_PARA="INST",
    VALE=(
        0.00000e00,
        0.00000e00,
        1.00000e-01,
        -1.80000e-04,
        2.00000e-01,
        -3.60000e-04,
        3.00000e-01,
        -5.40000e-04,
        4.00000e-01,
        -7.20000e-04,
        5.00000e-01,
        -9.00000e-04,
        6.00000e-01,
        -1.08000e-03,
        7.00000e-01,
        -1.26000e-03,
        8.00000e-01,
        -1.89000e-03,
        9.00000e-01,
        -2.97000e-03,
        1.00000e00,
        -4.05000e-03,
        1.10000e00,
        -3.87000e-03,
        1.20000e00,
        -3.69000e-03,
        1.30000e00,
        -3.51000e-03,
        1.40000e00,
        -3.33000e-03,
        1.50000e00,
        -3.15000e-03,
        1.60000e00,
        -2.97000e-03,
        1.70000e00,
        -2.79000e-03,
        1.80000e00,
        -2.61000e-03,
        1.90000e00,
        -2.43000e-03,
        2.00000e00,
        -2.25000e-03,
        2.10000e00,
        -2.07000e-03,
        2.20000e00,
        -1.89000e-03,
        2.30000e00,
        -1.71000e-03,
        2.40000e00,
        -1.53000e-03,
        2.50000e00,
        -1.35000e-03,
        2.51250e00,
        -1.21500e-03,
        2.52500e00,
        -1.08000e-03,
        2.53750e00,
        -9.45000e-04,
        2.55000e00,
        -8.10000e-04,
        2.56250e00,
        -6.75000e-04,
        2.66250e00,
        -9.11250e-04,
        2.76250e00,
        -1.14750e-03,
        2.86250e00,
        -1.38375e-03,
        2.96250e00,
        -1.62000e-03,
        3.06250e00,
        -1.85625e-03,
        3.16250e00,
        -2.09250e-03,
        3.26250e00,
        -2.32875e-03,
        3.36250e00,
        -2.56500e-03,
        3.46250e00,
        -2.80125e-03,
        3.56250e00,
        -3.03750e-03,
        3.66250e00,
        -2.80125e-03,
        3.76250e00,
        -2.56500e-03,
        3.86250e00,
        -2.32875e-03,
        3.96250e00,
        -2.09250e-03,
        4.06250e00,
        -1.85625e-03,
        4.16250e00,
        -1.62000e-03,
        4.26250e00,
        -1.38375e-03,
        4.36250e00,
        -1.14750e-03,
        4.46250e00,
        -9.11250e-04,
        4.56250e00,
        -6.75000e-04,
    ),
)

EPSTZZ2 = DEFI_FONCTION(
    NOM_PARA="INST",
    VALE=(
        0.00000e00,
        0.00000e00,
        1.00000e-01,
        -1.80000e-04,
        2.00000e-01,
        -3.60000e-04,
        3.00000e-01,
        -5.40000e-04,
        4.00000e-01,
        -7.20000e-04,
        5.00000e-01,
        -9.00000e-04,
        6.00000e-01,
        -1.08000e-03,
        7.00000e-01,
        -1.26000e-03,
        8.00000e-01,
        -1.89000e-03,
        9.00000e-01,
        -2.97000e-03,
        1.00000e00,
        -4.05000e-03,
        1.10000e00,
        -3.87000e-03,
        1.20000e00,
        -3.69000e-03,
        1.30000e00,
        -3.51000e-03,
        1.40000e00,
        -3.33000e-03,
        1.50000e00,
        -3.15000e-03,
        1.60000e00,
        -2.97000e-03,
        1.70000e00,
        -2.79000e-03,
        1.80000e00,
        -2.61000e-03,
        1.90000e00,
        -2.43000e-03,
        2.00000e00,
        -2.25000e-03,
        2.10000e00,
        -2.07000e-03,
        2.20000e00,
        -1.89000e-03,
        2.30000e00,
        -1.71000e-03,
        2.40000e00,
        -1.53000e-03,
        2.50000e00,
        -1.35000e-03,
        2.51250e00,
        -1.21500e-03,
        2.52500e00,
        -1.08000e-03,
        2.53750e00,
        -9.45000e-04,
        2.55000e00,
        -8.10000e-04,
        2.56250e00,
        -6.75000e-04,
        2.66250e00,
        -9.11250e-04,
        2.76250e00,
        -1.14750e-03,
        2.86250e00,
        -1.38375e-03,
        2.96250e00,
        -1.62000e-03,
        3.06250e00,
        -1.85625e-03,
        3.16250e00,
        -2.09250e-03,
        3.26250e00,
        -2.32875e-03,
        3.36250e00,
        -2.56500e-03,
        3.46250e00,
        -2.80125e-03,
        3.56250e00,
        -3.03750e-03,
        3.66250e00,
        -2.80125e-03,
        3.76250e00,
        -2.56500e-03,
        3.86250e00,
        -2.32875e-03,
        3.96250e00,
        -2.09250e-03,
        4.06250e00,
        -1.85625e-03,
        4.16250e00,
        -1.62000e-03,
        4.26250e00,
        -1.38375e-03,
        4.36250e00,
        -1.14750e-03,
        4.46250e00,
        -9.11250e-04,
        4.56250e00,
        -6.75000e-04,
    ),
)

FATN2 = [None] * (NBPR - 1)
FATNW2 = [None] * (NBPR - 1)
FATNF2 = [None] * (NBPR - 1)

RESU2 = [2.408735e-4, 2.408735e-4, 1.322816e-4]
RESU2C = [2.4087352144764e-4, 2.4087352146645e-4, 1.322816e-4]

RESUF2 = [1.449229e-4, 1.449229e-4, 6.53204991059937e-5]
RESUF2C = [1.4492289002336e-4, 1.4492289003382e-4, 6.53204991059937e-5]

for i in range(NBPR - 2):

    FATN2[i] = POST_FATIGUE(
        CHARGEMENT="MULTIAXIAL",
        HISTOIRE=_F(
            SIGM_XX=SIGMXX2,
            SIGM_YY=ZERO2,
            SIGM_ZZ=ZERO2,
            SIGM_XY=ZERO2,
            SIGM_XZ=ZERO2,
            SIGM_YZ=ZERO2,
            EPS_XX=EPSTXX2,
            EPS_YY=EPSTYY2,
            EPS_ZZ=EPSTZZ2,
            EPS_XY=ZERO2,
            EPS_XZ=ZERO2,
            EPS_YZ=ZERO2,
        ),
        TYPE_CHARGE="NON_PERIODIQUE",
        CRITERE="FORMULE_CRITERE",
        FORMULE_GRDEQ=CRIT[i],
        DOMMAGE="MANSON_COFFIN",
        MATER=MAT0,
        PROJECTION="UN_AXE",
    )

    IMPR_TABLE(TABLE=FATN2[i])

    TEST_TABLE(
        TABLE=FATN2[i],
        NOM_PARA="DOMMAGE",
        VALE_REFE=RESU2[i],
        VALE_CALC=RESU2C[i],
        REFERENCE="ANALYTIQUE",
        PRECISION=1.0e-4,
    )

for i in range(NBPR - 2):

    FATNW2[i] = POST_FATIGUE(
        CHARGEMENT="MULTIAXIAL",
        HISTOIRE=_F(
            SIGM_XX=SIGMXX2,
            SIGM_YY=ZERO2,
            SIGM_ZZ=ZERO2,
            SIGM_XY=ZERO2,
            SIGM_XZ=ZERO2,
            SIGM_YZ=ZERO2,
            EPS_XX=EPSTXX2,
            EPS_YY=EPSTYY2,
            EPS_ZZ=EPSTZZ2,
            EPS_XY=ZERO2,
            EPS_XZ=ZERO2,
            EPS_YZ=ZERO2,
        ),
        TYPE_CHARGE="NON_PERIODIQUE",
        CRITERE="FORMULE_CRITERE",
        FORMULE_GRDEQ=CRIT[i],
        DOMMAGE="FORM_VIE",
        FORMULE_VIE=MANCOF,
        MATER=MAT0,
        PROJECTION="UN_AXE",
    )

    IMPR_TABLE(TABLE=FATNW2[i])

    TEST_TABLE(
        TABLE=FATNW2[i],
        NOM_PARA="DOMMAGE",
        VALE_REFE=RESU2[i],
        VALE_CALC=RESU2C[i],
        REFERENCE="ANALYTIQUE",
        PRECISION=2.5e-3,
    )

for i in range(NBPR - 2):

    FATNF2[i] = POST_FATIGUE(
        CHARGEMENT="MULTIAXIAL",
        HISTOIRE=_F(
            SIGM_XX=SIGMXX2,
            SIGM_YY=ZERO2,
            SIGM_ZZ=ZERO2,
            SIGM_XY=ZERO2,
            SIGM_XZ=ZERO2,
            SIGM_YZ=ZERO2,
            EPS_XX=EPSTXX2,
            EPS_YY=EPSTYY2,
            EPS_ZZ=EPSTZZ2,
            EPS_XY=ZERO2,
            EPS_XZ=ZERO2,
            EPS_YZ=ZERO2,
        ),
        TYPE_CHARGE="NON_PERIODIQUE",
        CRITERE="FORMULE_CRITERE",
        FORMULE_GRDEQ=CRIT[i],
        DOMMAGE="FORM_VIE",
        FORMULE_VIE=MANCO1,
        MATER=MAT0,
        PROJECTION="UN_AXE",
    )

    IMPR_TABLE(TABLE=FATNF2[i])

    TEST_TABLE(
        TABLE=FATNF2[i],
        NOM_PARA="DOMMAGE",
        VALE_REFE=RESUF2[i],
        VALE_CALC=RESUF2C[i],
        REFERENCE="ANALYTIQUE",
        PRECISION=1.0e-5,
    )

#######################################################
# ASSOCIE AVEC LA SOLUTION SOL_NL3 de SSLV135f
#######################################################
SIGMXX3 = DEFI_FONCTION(
    NOM_PARA="INST",
    VALE=(
        0.00000e00,
        0.00000e00,
        1.00000e-01,
        1.80000e02,
        2.00000e-01,
        3.60000e02,
        3.00000e-01,
        5.40000e02,
        4.00000e-01,
        7.20000e02,
        5.00000e-01,
        9.00000e02,
        6.00000e-01,
        1.08000e03,
        7.00000e-01,
        1.26000e03,
        8.00000e-01,
        1.44000e03,
        9.00000e-01,
        1.62000e03,
        1.00000e00,
        1.80000e03,
        1.10000e00,
        1.56000e03,
        1.20000e00,
        1.32000e03,
        1.30000e00,
        1.08000e03,
        1.40000e00,
        8.40000e02,
        1.50000e00,
        6.00000e02,
        1.60000e00,
        3.60000e02,
        1.70000e00,
        1.20000e02,
        1.80000e00,
        -1.20000e02,
        1.90000e00,
        -3.60000e02,
        2.00000e00,
        -6.00000e02,
        2.10000e00,
        -3.00000e02,
        2.20000e00,
        3.52557e-09,
        2.30000e00,
        3.00000e02,
        2.40000e00,
        6.00000e02,
        2.50000e00,
        9.00000e02,
        2.60000e00,
        1.20000e03,
        2.70000e00,
        1.50000e03,
        2.80000e00,
        1.80000e03,
        2.90000e00,
        2.10000e03,
        3.00000e00,
        2.40000e03,
        3.10000e00,
        2.04000e03,
        3.20000e00,
        1.68000e03,
        3.30000e00,
        1.32000e03,
        3.40000e00,
        9.60000e02,
        3.50000e00,
        6.00000e02,
        3.60000e00,
        2.40000e02,
        3.70000e00,
        -1.20000e02,
        3.80000e00,
        -4.80000e02,
        3.90000e00,
        -8.40000e02,
        3.90833e00,
        -8.70000e02,
        3.91667e00,
        -9.00000e02,
    ),
)

ZERO3 = DEFI_FONCTION(
    NOM_PARA="INST",
    VALE=(
        0.00000e00,
        0,
        1.00000e-01,
        0,
        2.00000e-01,
        0,
        3.00000e-01,
        0,
        4.00000e-01,
        0,
        5.00000e-01,
        0,
        6.00000e-01,
        0,
        7.00000e-01,
        0,
        8.00000e-01,
        0,
        9.00000e-01,
        0,
        1.00000e00,
        0,
        1.10000e00,
        0,
        1.20000e00,
        0,
        1.30000e00,
        0,
        1.40000e00,
        0,
        1.50000e00,
        0,
        1.60000e00,
        0,
        1.70000e00,
        0,
        1.80000e00,
        0,
        1.90000e00,
        0,
        2.00000e00,
        0,
        2.10000e00,
        0,
        2.20000e00,
        0,
        2.30000e00,
        0,
        2.40000e00,
        0,
        2.50000e00,
        0,
        2.60000e00,
        0,
        2.70000e00,
        0,
        2.80000e00,
        0,
        2.90000e00,
        0,
        3.00000e00,
        0,
        3.10000e00,
        0,
        3.20000e00,
        0,
        3.30000e00,
        0,
        3.40000e00,
        0,
        3.50000e00,
        0,
        3.60000e00,
        0,
        3.70000e00,
        0,
        3.80000e00,
        0,
        3.90000e00,
        0,
        3.90833e00,
        0,
        3.91667e00,
        0,
    ),
)

EPSTXX3 = DEFI_FONCTION(
    NOM_PARA="INST",
    VALE=(
        0.00000e00,
        0.00000e00,
        1.00000e-01,
        9.00000e-04,
        2.00000e-01,
        1.80000e-03,
        3.00000e-01,
        2.70000e-03,
        4.00000e-01,
        3.60000e-03,
        5.00000e-01,
        4.50000e-03,
        6.00000e-01,
        8.10000e-03,
        7.00000e-01,
        1.17000e-02,
        8.00000e-01,
        1.53000e-02,
        9.00000e-01,
        1.89000e-02,
        1.00000e00,
        2.25000e-02,
        1.10000e00,
        2.13000e-02,
        1.20000e00,
        2.01000e-02,
        1.30000e00,
        1.89000e-02,
        1.40000e00,
        1.77000e-02,
        1.50000e00,
        1.65000e-02,
        1.60000e00,
        1.53000e-02,
        1.70000e00,
        1.41000e-02,
        1.80000e00,
        1.11000e-02,
        1.90000e00,
        6.30000e-03,
        2.00000e00,
        1.50000e-03,
        2.10000e00,
        3.00000e-03,
        2.20000e00,
        4.50000e-03,
        2.30000e00,
        6.00000e-03,
        2.40000e00,
        7.50000e-03,
        2.50000e00,
        9.00000e-03,
        2.60000e00,
        1.05000e-02,
        2.70000e00,
        1.65000e-02,
        2.80000e00,
        2.25000e-02,
        2.90000e00,
        2.85000e-02,
        3.00000e00,
        3.45000e-02,
        3.10000e00,
        3.27000e-02,
        3.20000e00,
        3.09000e-02,
        3.30000e00,
        2.91000e-02,
        3.40000e00,
        2.73000e-02,
        3.50000e00,
        2.55000e-02,
        3.60000e00,
        1.83000e-02,
        3.70000e00,
        1.11000e-02,
        3.80000e00,
        3.90000e-03,
        3.90000e00,
        -3.30000e-03,
        3.90833e00,
        -3.90000e-03,
        3.91667e00,
        -4.50000e-03,
    ),
)


EPSTYY3 = DEFI_FONCTION(
    NOM_PARA="INST",
    VALE=(
        0.00000e00,
        0.00000e00,
        1.00000e-01,
        -2.70000e-04,
        2.00000e-01,
        -5.40000e-04,
        3.00000e-01,
        -8.10000e-04,
        4.00000e-01,
        -1.08000e-03,
        5.00000e-01,
        -1.35000e-03,
        6.00000e-01,
        -2.97000e-03,
        7.00000e-01,
        -4.59000e-03,
        8.00000e-01,
        -6.21000e-03,
        9.00000e-01,
        -7.83000e-03,
        1.00000e00,
        -9.45000e-03,
        1.10000e00,
        -9.09000e-03,
        1.20000e00,
        -8.73000e-03,
        1.30000e00,
        -8.37000e-03,
        1.40000e00,
        -8.01000e-03,
        1.50000e00,
        -7.65000e-03,
        1.60000e00,
        -7.29000e-03,
        1.70000e00,
        -6.93000e-03,
        1.80000e00,
        -5.67000e-03,
        1.90000e00,
        -3.51000e-03,
        2.00000e00,
        -1.35000e-03,
        2.10000e00,
        -1.80000e-03,
        2.20000e00,
        -2.25000e-03,
        2.30000e00,
        -2.70000e-03,
        2.40000e00,
        -3.15000e-03,
        2.50000e00,
        -3.60000e-03,
        2.60000e00,
        -4.05000e-03,
        2.70000e00,
        -6.75000e-03,
        2.80000e00,
        -9.45000e-03,
        2.90000e00,
        -1.21500e-02,
        3.00000e00,
        -1.48500e-02,
        3.10000e00,
        -1.43100e-02,
        3.20000e00,
        -1.37700e-02,
        3.30000e00,
        -1.32300e-02,
        3.40000e00,
        -1.26900e-02,
        3.50000e00,
        -1.21500e-02,
        3.60000e00,
        -8.91000e-03,
        3.70000e00,
        -5.67000e-03,
        3.80000e00,
        -2.43000e-03,
        3.90000e00,
        8.10000e-04,
        3.90833e00,
        1.08000e-03,
        3.91667e00,
        1.35000e-03,
    ),
)

EPSTZZ3 = DEFI_FONCTION(
    NOM_PARA="INST",
    VALE=(
        0.00000e00,
        0.00000e00,
        1.00000e-01,
        -2.70000e-04,
        2.00000e-01,
        -5.40000e-04,
        3.00000e-01,
        -8.10000e-04,
        4.00000e-01,
        -1.08000e-03,
        5.00000e-01,
        -1.35000e-03,
        6.00000e-01,
        -2.97000e-03,
        7.00000e-01,
        -4.59000e-03,
        8.00000e-01,
        -6.21000e-03,
        9.00000e-01,
        -7.83000e-03,
        1.00000e00,
        -9.45000e-03,
        1.10000e00,
        -9.09000e-03,
        1.20000e00,
        -8.73000e-03,
        1.30000e00,
        -8.37000e-03,
        1.40000e00,
        -8.01000e-03,
        1.50000e00,
        -7.65000e-03,
        1.60000e00,
        -7.29000e-03,
        1.70000e00,
        -6.93000e-03,
        1.80000e00,
        -5.67000e-03,
        1.90000e00,
        -3.51000e-03,
        2.00000e00,
        -1.35000e-03,
        2.10000e00,
        -1.80000e-03,
        2.20000e00,
        -2.25000e-03,
        2.30000e00,
        -2.70000e-03,
        2.40000e00,
        -3.15000e-03,
        2.50000e00,
        -3.60000e-03,
        2.60000e00,
        -4.05000e-03,
        2.70000e00,
        -6.75000e-03,
        2.80000e00,
        -9.45000e-03,
        2.90000e00,
        -1.21500e-02,
        3.00000e00,
        -1.48500e-02,
        3.10000e00,
        -1.43100e-02,
        3.20000e00,
        -1.37700e-02,
        3.30000e00,
        -1.32300e-02,
        3.40000e00,
        -1.26900e-02,
        3.50000e00,
        -1.21500e-02,
        3.60000e00,
        -8.91000e-03,
        3.70000e00,
        -5.67000e-03,
        3.80000e00,
        -2.43000e-03,
        3.90000e00,
        8.10000e-04,
        3.90833e00,
        1.08000e-03,
        3.91667e00,
        1.35000e-03,
    ),
)

EPSPXX3 = DEFI_FONCTION(
    NOM_PARA="INST",
    VALE=(
        0.00000e00,
        0.00000e00,
        1.00000e-01,
        -4.98524e-19,
        2.00000e-01,
        -1.51399e-18,
        3.00000e-01,
        -1.81020e-18,
        4.00000e-01,
        -8.17044e-19,
        5.00000e-01,
        -2.40936e-18,
        6.00000e-01,
        2.70000e-03,
        7.00000e-01,
        5.40000e-03,
        8.00000e-01,
        8.10000e-03,
        9.00000e-01,
        1.08000e-02,
        1.00000e00,
        1.35000e-02,
        1.10000e00,
        1.35000e-02,
        1.20000e00,
        1.35000e-02,
        1.30000e00,
        1.35000e-02,
        1.40000e00,
        1.35000e-02,
        1.50000e00,
        1.35000e-02,
        1.60000e00,
        1.35000e-02,
        1.70000e00,
        1.35000e-02,
        1.80000e00,
        1.17000e-02,
        1.90000e00,
        8.10000e-03,
        2.00000e00,
        4.50000e-03,
        2.10000e00,
        4.50000e-03,
        2.20000e00,
        4.50000e-03,
        2.30000e00,
        4.50000e-03,
        2.40000e00,
        4.50000e-03,
        2.50000e00,
        4.50000e-03,
        2.60000e00,
        4.50000e-03,
        2.70000e00,
        9.00000e-03,
        2.80000e00,
        1.35000e-02,
        2.90000e00,
        1.80000e-02,
        3.00000e00,
        2.25000e-02,
        3.10000e00,
        2.25000e-02,
        3.20000e00,
        2.25000e-02,
        3.30000e00,
        2.25000e-02,
        3.40000e00,
        2.25000e-02,
        3.50000e00,
        2.25000e-02,
        3.60000e00,
        1.71000e-02,
        3.70000e00,
        1.17000e-02,
        3.80000e00,
        6.30000e-03,
        3.90000e00,
        9.00000e-04,
        3.90833e00,
        4.50000e-04,
        3.91667e00,
        -6.96511e-11,
    ),
)

EPSPYY3 = DEFI_FONCTION(
    NOM_PARA="INST",
    VALE=(
        0.00000e00,
        0.00000e00,
        1.00000e-01,
        3.36555e-20,
        2.00000e-01,
        -1.04528e-19,
        3.00000e-01,
        -9.70465e-19,
        4.00000e-01,
        -8.56728e-19,
        5.00000e-01,
        -1.52073e-18,
        6.00000e-01,
        -1.35000e-03,
        7.00000e-01,
        -2.70000e-03,
        8.00000e-01,
        -4.05000e-03,
        9.00000e-01,
        -5.40000e-03,
        1.00000e00,
        -6.75000e-03,
        1.10000e00,
        -6.75000e-03,
        1.20000e00,
        -6.75000e-03,
        1.30000e00,
        -6.75000e-03,
        1.40000e00,
        -6.75000e-03,
        1.50000e00,
        -6.75000e-03,
        1.60000e00,
        -6.75000e-03,
        1.70000e00,
        -6.75000e-03,
        1.80000e00,
        -5.85000e-03,
        1.90000e00,
        -4.05000e-03,
        2.00000e00,
        -2.25000e-03,
        2.10000e00,
        -2.25000e-03,
        2.20000e00,
        -2.25000e-03,
        2.30000e00,
        -2.25000e-03,
        2.40000e00,
        -2.25000e-03,
        2.50000e00,
        -2.25000e-03,
        2.60000e00,
        -2.25000e-03,
        2.70000e00,
        -4.50000e-03,
        2.80000e00,
        -6.75000e-03,
        2.90000e00,
        -9.00000e-03,
        3.00000e00,
        -1.12500e-02,
        3.10000e00,
        -1.12500e-02,
        3.20000e00,
        -1.12500e-02,
        3.30000e00,
        -1.12500e-02,
        3.40000e00,
        -1.12500e-02,
        3.50000e00,
        -1.12500e-02,
        3.60000e00,
        -8.55000e-03,
        3.70000e00,
        -5.85000e-03,
        3.80000e00,
        -3.15000e-03,
        3.90000e00,
        -4.50000e-04,
        3.90833e00,
        -2.25000e-04,
        3.91667e00,
        3.29156e-11,
    ),
)

EPSPZZ3 = DEFI_FONCTION(
    NOM_PARA="INST",
    VALE=(
        0.00000e00,
        0.00000e00,
        1.00000e-01,
        2.71051e-20,
        2.00000e-01,
        -1.82473e-19,
        3.00000e-01,
        -1.91681e-19,
        4.00000e-01,
        1.58738e-19,
        5.00000e-01,
        1.58738e-19,
        6.00000e-01,
        -1.35000e-03,
        7.00000e-01,
        -2.70000e-03,
        8.00000e-01,
        -4.05000e-03,
        9.00000e-01,
        -5.40000e-03,
        1.00000e00,
        -6.75000e-03,
        1.10000e00,
        -6.75000e-03,
        1.20000e00,
        -6.75000e-03,
        1.30000e00,
        -6.75000e-03,
        1.40000e00,
        -6.75000e-03,
        1.50000e00,
        -6.75000e-03,
        1.60000e00,
        -6.75000e-03,
        1.70000e00,
        -6.75000e-03,
        1.80000e00,
        -5.85000e-03,
        1.90000e00,
        -4.05000e-03,
        2.00000e00,
        -2.25000e-03,
        2.10000e00,
        -2.25000e-03,
        2.20000e00,
        -2.25000e-03,
        2.30000e00,
        -2.25000e-03,
        2.40000e00,
        -2.25000e-03,
        2.50000e00,
        -2.25000e-03,
        2.60000e00,
        -2.25000e-03,
        2.70000e00,
        -4.50000e-03,
        2.80000e00,
        -6.75000e-03,
        2.90000e00,
        -9.00000e-03,
        3.00000e00,
        -1.12500e-02,
        3.10000e00,
        -1.12500e-02,
        3.20000e00,
        -1.12500e-02,
        3.30000e00,
        -1.12500e-02,
        3.40000e00,
        -1.12500e-02,
        3.50000e00,
        -1.12500e-02,
        3.60000e00,
        -8.55000e-03,
        3.70000e00,
        -5.85000e-03,
        3.80000e00,
        -3.15000e-03,
        3.90000e00,
        -4.50000e-04,
        3.90833e00,
        -2.25000e-04,
        3.91667e00,
        3.67356e-11,
    ),
)

FATN3 = POST_FATIGUE(
    CHARGEMENT="MULTIAXIAL",
    HISTOIRE=_F(
        SIGM_XX=SIGMXX3,
        SIGM_YY=ZERO3,
        SIGM_ZZ=ZERO3,
        SIGM_XY=ZERO3,
        SIGM_XZ=ZERO3,
        SIGM_YZ=ZERO3,
        EPS_XX=EPSTXX3,
        EPS_YY=EPSTYY3,
        EPS_ZZ=EPSTZZ3,
        EPS_XY=ZERO3,
        EPS_XZ=ZERO3,
        EPS_YZ=ZERO3,
        EPSP_XX=EPSPXX3,
        EPSP_YY=EPSPYY3,
        EPSP_ZZ=EPSPZZ3,
        EPSP_XY=ZERO3,
        EPSP_XZ=ZERO3,
        EPSP_YZ=ZERO3,
    ),
    TYPE_CHARGE="NON_PERIODIQUE",
    CRITERE="FORMULE_CRITERE",
    FORMULE_GRDEQ=CRIT[3],
    DOMMAGE="MANSON_COFFIN",
    MATER=MAT0,
    PROJECTION="UN_AXE",
)

IMPR_TABLE(TABLE=FATN3)

TEST_TABLE(
    TABLE=FATN3,
    NOM_PARA="DOMMAGE",
    VALE_REFE=2.1858445e-3,
    VALE_CALC=2.1858444715591e-3,
    REFERENCE="ANALYTIQUE",
    PRECISION=1.0e-4,
)

FATNW3 = POST_FATIGUE(
    CHARGEMENT="MULTIAXIAL",
    HISTOIRE=_F(
        SIGM_XX=SIGMXX3,
        SIGM_YY=ZERO3,
        SIGM_ZZ=ZERO3,
        SIGM_XY=ZERO3,
        SIGM_XZ=ZERO3,
        SIGM_YZ=ZERO3,
        EPS_XX=EPSTXX3,
        EPS_YY=EPSTYY3,
        EPS_ZZ=EPSTZZ3,
        EPS_XY=ZERO3,
        EPS_XZ=ZERO3,
        EPS_YZ=ZERO3,
        EPSP_XX=EPSPXX3,
        EPSP_YY=EPSPYY3,
        EPSP_ZZ=EPSPZZ3,
        EPSP_XY=ZERO3,
        EPSP_XZ=ZERO3,
        EPSP_YZ=ZERO3,
    ),
    TYPE_CHARGE="NON_PERIODIQUE",
    CRITERE="FORMULE_CRITERE",
    FORMULE_GRDEQ=CRIT[3],
    DOMMAGE="FORM_VIE",
    FORMULE_VIE=MANCOF,
    MATER=MAT0,
    PROJECTION="UN_AXE",
)

IMPR_TABLE(TABLE=FATNW3)

TEST_TABLE(
    TABLE=FATNW3,
    NOM_PARA="DOMMAGE",
    VALE_REFE=2.1858445e-3,
    VALE_CALC=2.1858444715591e-3,
    REFERENCE="ANALYTIQUE",
    PRECISION=2.5e-3,
)


FATNF3 = POST_FATIGUE(
    CHARGEMENT="MULTIAXIAL",
    HISTOIRE=_F(
        SIGM_XX=SIGMXX3,
        SIGM_YY=ZERO3,
        SIGM_ZZ=ZERO3,
        SIGM_XY=ZERO3,
        SIGM_XZ=ZERO3,
        SIGM_YZ=ZERO3,
        EPS_XX=EPSTXX3,
        EPS_YY=EPSTYY3,
        EPS_ZZ=EPSTZZ3,
        EPS_XY=ZERO3,
        EPS_XZ=ZERO3,
        EPS_YZ=ZERO3,
        EPSP_XX=EPSPXX3,
        EPSP_YY=EPSPYY3,
        EPSP_ZZ=EPSPZZ3,
        EPSP_XY=ZERO3,
        EPSP_XZ=ZERO3,
        EPSP_YZ=ZERO3,
    ),
    TYPE_CHARGE="NON_PERIODIQUE",
    CRITERE="FORMULE_CRITERE",
    FORMULE_GRDEQ=CRIT[3],
    DOMMAGE="FORM_VIE",
    FORMULE_VIE=MANCO1,
    MATER=MAT0,
    PROJECTION="UN_AXE",
)

IMPR_TABLE(TABLE=FATNF3)

TEST_TABLE(
    TABLE=FATNF3,
    NOM_PARA="DOMMAGE",
    VALE_REFE=1.377855e-2,
    VALE_CALC=1.37785513e-2,
    REFERENCE="ANALYTIQUE",
    PRECISION=1.0e-5,
)
FIN()
#
